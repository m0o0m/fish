var AssetAdapter=function(){function e(){}var t=(__define,e),n=t.prototype;return n.getAsset=function(e,t,n){function i(i){t.call(n,i,e)}if(RES.hasRes(e)){var s=RES.getRes(e);s?i(s):RES.getResAsync(e,i,this)}else RES.getResByUrl(e,i,this,RES.ResourceItem.TYPE_IMAGE)},e}();egret.registerClass(AssetAdapter,"AssetAdapter",["eui.IAssetAdapter"]);var BaseGameEntity=function(){function e(){this.sid=e.index+"",e.index++}var t=(__define,e);t.prototype;return e.index=0,e}();egret.registerClass(BaseGameEntity,"BaseGameEntity");var EntityManager=function(){function e(){this._length=0,this._entityMap={}}var t=__define,n=e,i=n.prototype;return t(e,"instance",function(){return null==this._instance&&(this._instance=new e),this._instance}),i.registerEntity=function(e){this._entityMap[e.sid]=e},i.getEntityFromID=function(e){return this._entityMap[e]},i.removeEntity=function(e){var t;for(t in this._entityMap)this._entityMap[t]==e&&delete this._entityMap[t]},i.getAllEntity=function(){return this._entityMap},i.getAvailableEntity=function(e){var t,n;for(t in this._entityMap){var i=this._entityMap[t];if(i instanceof e&&null!=i&&1==i.isDestroy)return n=i}return n=this.createEntity(e)},i.createEntity=function(e){var t=new e;return t.isDestroy=!1,this.registerEntity(t),this._length++,t},t(i,"length",function(){return this._length}),e}();egret.registerClass(EntityManager,"EntityManager");var BaseMovingEntity=function(e){function t(){e.call(this),this._speed=0,this.hitBox=new egret.Rectangle}__extends(t,e);var n=__define,i=t,s=i.prototype;return n(s,"position",function(){return this._position},function(e){this._position=e,this.displayObject.x=this.position.x,this.displayObject.y=this.position.y}),n(s,"speed",function(){return this._speed},function(e){this._speed=e,this.setSpeedXY()}),n(s,"rotation",function(){return this._rotation},function(e){this._rotation=e,this.displayObject.rotation=this._rotation,this.setSpeedXY()}),s.setSpeedXY=function(){if(this._rotation&&this.speed>0){var e=this.rotation/57;this.speedX=this.speed*Math.cos(e),this.speedY=this.speed*Math.sin(e)}},t}(BaseGameEntity);egret.registerClass(BaseMovingEntity,"BaseMovingEntity");var FishStateSeek=function(){function e(){}var t=__define,n=e,i=n.prototype;return t(e,"instance",function(){return null==this._instance&&(this._instance=new e),this._instance}),i.onMessage=function(e,t){return!1},i.enter=function(e){this.client=ClientModel.instance,e.isDestroy=!1;var t=e;0==t.pathStep&&(t.clientPathList=t.pathList,t.currentPath=t.clientPathList[0],t.pathStep=1,t.rotation=t.currentPath.rotation,e.getDisplayObject().x=t.currentPath.x,e.getDisplayObject().y=t.currentPath.y)},i.execute=function(e){var t=e,n=t.clientPathList[t.pathStep];null==n?e.getFSM().ChangeState(FishStateDestroy.instance):(e.getDisplayObject().y=n.y,e.getDisplayObject().x=n.x,e.getDisplayObject().rotation=n.rotation,t.pathStep++)},i.exit=function(e){},e}();egret.registerClass(FishStateSeek,"FishStateSeek",["IState","IBase"]);var FishStateArrive=function(){function e(){}var t=__define,n=e,i=n.prototype;return t(e,"instance",function(){return null==this._instance&&(this._instance=new e),this._instance}),i.onMessage=function(e,t){return!1},i.enter=function(e){var t=e;t.pathStep>=t.pathList.length?e.getFSM().ChangeState(FishStateDestroy.instance):(t.pathStep+=1,e.getFSM().ChangeState(FishStateSeek.instance))},i.execute=function(e){},i.exit=function(e){e.isDestroy=!0},e}();egret.registerClass(FishStateArrive,"FishStateArrive",["IState","IBase"]);var FishStateDeath=function(){function e(){}var t=__define,n=e,i=n.prototype;return t(e,"instance",function(){return null==this._instance&&(this._instance=new e),this._instance}),i.onMessage=function(e,t){return!1},i.enter=function(e){var t=e;t.displayObject.stop();var n=t.getDataVo(FishVo).id,i=MovieclipUtils.createMc("fishd"+n+"_png","fishd"+n+"_json");i.x=t.displayObject.x,i.y=t.displayObject.y,i.rotation=t.displayObject.rotation,i.anchorOffsetX=i.width>>1,i.anchorOffsetY=i.height>>1,t.displayObject.parent.addChildAt(i,1),t.displayObject.parent.removeChild(t.displayObject),t.displayObject=i;var s=new egret.BitmapText;s.font=RES.getRes("sy1_fnt"),s.width=t.displayObject.width,s.textAlign=egret.HorizontalAlign.CENTER,s.x=t.displayObject.x,s.y=t.displayObject.y,s.text="x"+t.getDataVo(FishVo).rate,t.displayObject.parent.addChild(s),i.gotoAndPlay(1,2),egret.Tween.get(this).wait(2*i.totalFrames/30*1e3).call(function(t){t.parent.removeChild(t),e.getFSM().ChangeState(FishStateDestroy.instance)},this,[s])},i.execute=function(e){},i.exit=function(e){},e}();egret.registerClass(FishStateDeath,"FishStateDeath",["IState","IBase"]);var FishStateDestroy=function(){function e(){}var t=__define,n=e,i=n.prototype;return t(e,"instance",function(){return null==this._instance&&(this._instance=new e),this._instance}),i.onMessage=function(e,t){return!1},i.enter=function(e){e.isDestroy=!0;var t=e;t.displayObject.stop(),null!=t.displayObject.parent&&t.displayObject.parent.removeChild(t.displayObject);for(var n=0;n<ClientModel.instance.fishList.length;n++)if(ClientModel.instance.fishList[n].sid==t.sid){ClientModel.instance.fishList.splice(n,1);break}},i.execute=function(e){},i.exit=function(e){},e}();egret.registerClass(FishStateDestroy,"FishStateDestroy",["IState","IBase"]);var ShellMovingEntityStateSeek=function(){function e(){}var t=__define,n=e,i=n.prototype;return t(e,"instance",function(){return null==this._instance&&(this._instance=new e),this._instance}),i.onMessage=function(e,t){return!1},i.enter=function(e){this.client=ClientModel.instance,e.isDestroy=!1},i.execute=function(e){e.getDisplayObject().y+=e.speedY,e.getDisplayObject().x+=e.speedX;var t=e.getDisplayObject(),n=!1;t.x<0?(t.x=0,e.speedX=-e.speedX,n=!0):t.x>GameWorld.GAME_WIDTH&&(t.x=GameWorld.GAME_WIDTH,e.speedX=-e.speedX,n=!0),t.y<0?(t.y=0,e.speedY=-e.speedY,n=!0):t.y>GameWorld.GAME_HEIGHT&&(t.y=GameWorld.GAME_HEIGHT,e.speedY=-e.speedY,n=!0),n&&(e.rotation=57*Math.atan2(e.speedY,e.speedX)),this.client.fishList.forEach(function(t){var n=t.displayObject;if(null!=n.parent&&t.getFSM().CurrentState==FishStateSeek.instance){var i=1.5*Math.max(n.width,n.height),s=e.getDisplayObject(),a=1.5*Math.max(s.width,s.height);n.x-s.x>-(i+a)&&n.x-s.x<i+a&&n.y-s.y>-(i+a)&&n.y-s.y<i+a&&HitTestUtils.hitTest(n,e.getDisplayObject())&&e.getFSM().ChangeState(ShellMovingEntityStateArrive.instance)}})},i.exit=function(e){},e}();egret.registerClass(ShellMovingEntityStateSeek,"ShellMovingEntityStateSeek",["IState","IBase"]);var ShellMovingEntityStateArrive=function(){function e(){}var t=__define,n=e,i=n.prototype;return t(e,"instance",function(){return null==this._instance&&(this._instance=new e),this._instance}),i.onMessage=function(e,t){return!1},i.enter=function(e){this.client=ClientModel.instance;var t=e;t.displayObject.movieClipData=t.mcf.generateMovieClipData(t.data.bomb),t.displayObject.gotoAndPlay(1,1),this.client.fishList.forEach(function(e){if(0==e.isDestroy){var n=t.displayObject,i=e.getDisplayObject(),s=1.5*Math.max(n.width,n.height),a=1.5*Math.max(i.width,i.height);if(n.x-i.x>-(s+a)&&n.x-i.x<s+a&&n.y-i.y>-(s+a)&&n.y-i.y<s+a&&(console.log("in hit"),HitTestUtils.hitTest(t.displayObject,e.getDisplayObject()))){if(console.log("hitTestLevel:"+e.getDataVo(FishVo).hitTestLevel),1==e.getDataVo(FishVo).hitTestLevel){var o=e.displayObject.$bitmapData;if(o.getPixel32(n.x,i.x)[3]<1)return void console.log(o.getPixel32(n.x,i.x)[3])}e.getFSM().ChangeState(FishStateDeath.instance),t.owner.killFish(e.getDataVo(FishVo))}}}),e.getFSM().ChangeState(ShellMovingEntityStateDeath.instance)},i.execute=function(e){},i.exit=function(e){},e}();egret.registerClass(ShellMovingEntityStateArrive,"ShellMovingEntityStateArrive",["IState","IBase"]);var ShellMovingEntityStateDeath=function(){function e(){}var t=__define,n=e,i=n.prototype;return t(e,"instance",function(){return null==this._instance&&(this._instance=new e),this._instance}),i.onMessage=function(e,t){return!1},i.enter=function(e){var t=e;egret.Tween.get(t.displayObject).to({alpha:0},350).call(function(){t.displayObject.parent?(t.displayObject.parent.removeChild(t.displayObject),e.isDestroy=!0,t.owner.clearnShell(t.sid),HitGoldAnimation.instance.enter({target:t.owner,money:99,x:t.displayObject.x,y:t.displayObject.y})):console.error("obj.displayObject.parent"+t.displayObject.parent)})},i.execute=function(e){},i.exit=function(e){},e}();egret.registerClass(ShellMovingEntityStateDeath,"ShellMovingEntityStateDeath",["IState","IBase"]);var StateMachine=function(){function e(e){this.m_pOwner=e,this.m_pCurrentState=null,this.m_pPreviousState=null,this.m_pGlobalState=null}var t=__define,n=e,i=n.prototype;return i.SetCurrentState=function(e){this.m_pCurrentState=e},i.SetPreviousState=function(e){this.m_pPreviousState=e},i.SetGlobalState=function(e){this.m_pGlobalState=e},i.Update=function(){null!=this.m_pGlobalState&&this.m_pGlobalState.execute(this.m_pOwner),null!=this.m_pCurrentState&&this.m_pCurrentState.execute(this.m_pOwner)},i.ChangeState=function(e){null==this.m_pCurrentState?(this.m_pCurrentState=e,this.m_pCurrentState.enter(this.m_pOwner)):null!=e?(this.m_pPreviousState=this.m_pCurrentState,this.m_pCurrentState.exit(this.m_pOwner),this.m_pCurrentState=e,this.m_pCurrentState.enter(this.m_pOwner)):console.error("pNewState:"+e)},i.HandleMessage=function(e){return this.m_pCurrentState&&this.m_pCurrentState.onMessage(this.m_pOwner,e)?!0:this.m_pGlobalState&&this.m_pGlobalState.onMessage(this.m_pOwner,e)?!0:!1},i.RevertToPreviousState=function(){this.ChangeState(this.m_pPreviousState)},i.isInState=function(e){return this.m_pCurrentState instanceof e?!0:!1},t(i,"CurrentState",function(){return this.m_pCurrentState}),t(i,"GlobalState",function(){return this.m_pGlobalState}),t(i,"PreviousState",function(){return this.m_pPreviousState}),i.GetNameOfCurrentState=function(){},e}();egret.registerClass(StateMachine,"StateMachine");var MessageDispatcher=function(){function e(){this.SEND_MSG_IMMEDIATELY=0,this.NO_ADDITIONAL_INFO=0,this.PriorityQ=new TreeSet,this.showList=new Array}var t=__define,n=e,i=n.prototype;return t(e,"instance",function(){return null==this._instance&&(this._instance=new e),this._instance}),i.Discharge=function(e,t){this.showList.push(t),!e.handleMessage(t)},t(i,"showListData",function(){return this.showList}),i.DispatchMessage=function(e,t,n,i,s){void 0===s&&(s=null);var a=(EntityManager.instance.getEntityFromID(t),EntityManager.instance.getEntityFromID(n));if(null==a)return void console.warn("\nWarning! No Receiver with ID of "+n+" found");var o=new Telegram(0,t,n,i,s);0>=e?this.Discharge(a,o):(o.DispatchTime=egret.getTimer(),this.PriorityQ.add(o))},i.DispatchDelayedMessages=function(){for(;!this.PriorityQ.isEmpty&&this.PriorityQ.first.DispatchTime<=egret.getTimer()&&this.PriorityQ.first.DispatchTime>0;){var e=this.PriorityQ.first,t=EntityManager.instance.getEntityFromID(e.Receiver);this.Discharge(t,e),this.PriorityQ.remove(this.PriorityQ.first)}},i.DispatchSimpleMessage=function(e,t){var n=e,i=t;if(null==i)return void console.warn("\nWarning! No Receiver with ID of "+t+" found");var s=new Telegram(0,n.sid,t.sid,0,null);this.Discharge(i,s)},e}();egret.registerClass(MessageDispatcher,"MessageDispatcher");var MessageType=function(){function e(){}var t=(__define,e);t.prototype;return e}();egret.registerClass(MessageType,"MessageType");var Telegram=function(){function e(e,t,n,i,s){void 0===s&&(s=null),this.SmallestDelay=.25,this.Sender=t,this.Receiver=n,this.Msg=i,this.DispatchTime=e,this.time=egret.getTimer()}var t=__define,n=e,i=n.prototype;return i.ExtraInfo=function(){},t(i,"sortSerial",function(){return this.DispatchTime}),e}();egret.registerClass(Telegram,"Telegram",["ICompositor"]);var FishPathUtil=function(){function e(){}var t=(__define,e);t.prototype;return e.createPath=function(e,t,n,i,s){for(var a=[],o=n.x,r=n.y,c=i.x,h=i.y,l=t.x,u=t.y,d=s.x,p=s.y,g=(l+o)/2,_=(u+r)/2,f=(o+c)/2,m=(r+h)/2,S=(c+d)/2,v=(h+p)/2,E=Math.sqrt((o-l)*(o-l)+(r-u)*(r-u)),L=Math.sqrt((c-o)*(c-o)+(h-r)*(h-r)),C=Math.sqrt((d-c)*(d-c)+(p-h)*(p-h)),y=E/(E+L),I=L/(L+C),T=g+(f-g)*y,M=_+(m-_)*y,A=f+(S-f)*I,G=m+(v-m)*I,x=Math.floor(L/n.speed),B=T+(f-T)*this.smooth_value+o-T,w=M+(m-M)*this.smooth_value+r-M,D=A+(f-A)*this.smooth_value+c-A,F=G+(m-G)*this.smooth_value+h-G,R=1/(x+1),b=R*R,H=R*R*R,P=3*R,O=3*b,k=6*b,N=6*H,U=o-2*B+D,V=r-2*w+F,W=3*(B-D)-o+c,j=3*(w-F)-r+h,K=o,Y=r,Q=(B-o)*P+U*O+W*H,q=(w-r)*P+V*O+j*H,X=U*k+W*N,z=V*k+j*N,Z=W*N,J=j*N,$=x;$--;){K+=Q,Y+=q,Q+=X,q+=z,X+=Z,z+=J;var et=new PathPointVo;et.index=e,et.x=K,et.y=Y,a.push(et),e++}return a},e.smooth_value=.6,e}();egret.registerClass(FishPathUtil,"FishPathUtil");var TreeSet=function(){function e(){this.list=new Array}var t=__define,n=e,i=n.prototype;return i.add=function(e){return this.list.indexOf(e)>-1?!1:(this.addElement(e),!0)},t(i,"isEmpty",function(){return this.list.length>0?!1:!0}),t(i,"size",function(){return this.list.length}),i.SortedSet=function(){this.list.sort(this.compareFunction)},i.compareFunction=function(e,t){return e.sortSerial>t.sortSerial?1:e.sortSerial<t.sortSerial?-1:0},i.remove=function(e){this.list.splice(this.list.indexOf(e),1),this.SortedSet()},t(i,"first",function(){return this.list[0]}),t(i,"last",function(){return this.list[this.list.length-1]}),i.addElement=function(e){this.list.push(e),this.SortedSet()},e}();egret.registerClass(TreeSet,"TreeSet");var Vector2Ds=function(){function e(e,t){void 0===e&&(e=0),void 0===t&&(t=0),this.x=e,this.y=t}var t=(__define,e),n=t.prototype;return n.zero=function(){this.x=0,this.y=0},n.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},n.lengthSq=function(){return this.x*this.x+this.y*this.y},n.dot=function(e){return this.x*e.x+this.y*e.y},n.sign=function(t){return this.y*t.x>this.x*t.y?e.anticlockwise:e.clockwise},n.perp=function(){return new e(-this.y,this.x)},n.distance=function(e){var t=e.y-this.y,n=e.x-this.x;return Math.sqrt(t*t+n*n)},n.distanceSq=function(e){var t=e.y-this.y,n=e.x-this.x;return t*t+n*n},n.truncate=function(e){this.length()>e&&(this.normalize(),Vector2DOperator.vectorByNum(this,e))},n.reflect=function(e){return Vector2DOperator.operatorAdd(this,Vector2DOperator.numByVector(2*this.dot(e),e.getReverse()))},n.getReverse=function(){return new e(-this.x,-this.y)},n.normalize=function(){var e=this.length();e>Vector2DOperator.epsilon&&(this.x/=e,this.y/=e)},n.vec2DNormalize=function(e){var t=e,n=t.length();return n>Vector2DOperator.epsilon&&(t.x/=n,t.y/=n),t},n.vec2DDistance=function(e,t){var n=t.y-e.y,i=t.x-e.x;return Math.sqrt(n*n+i*i)},n.vec2DDistanceSq=function(e,t){var n=t.y-e.y,i=t.x-e.x;return n*n+i*i},n.vec2DLength=function(e){return Math.sqrt(e.x*e.x+e.y*e.y)},n.vec2DLengthSq=function(e){return e.x*e.x+e.y*e.y},n.POINTStoVector=function(t){return new e(t.x,t.y)},n.POINTtoVector=function(t){return new e(t.x,t.y)},n.vectorToPOINTS=function(e){var t;return t.x=e.x,t.y=e.y,t},n.vectorToPOINT=function(e){var t;return t.x=e.x,t.y=e.y,t},n.wrapAround=function(e,t,n){e.x>t&&(e.x=0),e.x<0&&(e.x=t),e.y<0&&(e.y=n),e.y>n&&(e.y=0)},n.notInsideRegion=function(e,t,n){return e.x<t.x||e.x>n.x||e.y<t.y||e.y>n.y},n.insideRegion3=function(e,t,n){return!(e.x<t.x||e.x>n.x||e.y<t.y||e.y>n.y)},n.insideRegion5=function(e,t,n,i,s){return!(e.x<t||e.x>i||e.y<n||e.y>s)},n.isSecondInFOVOfFirst=function(e,t,n,i){var s=this.vec2DNormalize(Vector2DOperator.operatorMinus(n,e));return t.dot(s)>=Math.cos(i/2)},n.clone=function(){return new e(this.x,this.y)},e.clockwise=1,e.anticlockwise=-1,e}();egret.registerClass(Vector2Ds,"Vector2Ds");var Vector2DOperator=function(){function e(){}var t=__define,n=e;n.prototype;return e.operatorAdd=function(e,t){return e.x+=t.x,e.y+=t.y,e},e.operatorMinus=function(e,t){return e.x-=t.x,e.y-=t.y,e},t(e,"epsilon",function(){var e=Number.MAX_VALUE-1,t=Math.abs(1+Number.MIN_VALUE);return Math.max(e,t)}),e.numByVector=function(e,t){return t.x=t.x*e,t.y=t.y*e,t},e.vectorByNum=function(e,t){return e.x=e.x*t,e.y=e.y*t,e},e}();egret.registerClass(Vector2DOperator,"Vector2DOperator");var ClientModel=function(){function e(){this._resLoaded=!1,this._language="zh_CN",this.user=UserModel.instance,this.moneyType="0"}var t=__define,n=e,i=n.prototype;return t(i,"isSimple",function(){return egret.Capabilities.isMobile&&"web"==egret.Capabilities.runtimeType||InterfaceManager.instance.isWeiXin?!0:!1}),t(e,"instance",function(){return null==this._instance&&(this._instance=new e),this._instance}),i.parseParams=function(){if(console.log("当前系统："+egret.Capabilities.os),console.log("移动设备："+egret.Capabilities.isMobile),console.log("系统语言："+egret.Capabilities.language),console.log("运行环境："+egret.Capabilities.runtimeType),egret.Capabilities.isMobile&&console.log("native support版本："+egret.Capabilities.supportVersion),egret.Capabilities.runtimeType==egret.RuntimeType.WEB){var e=window.document.location.href.toString();console.log("浏览器地址："+e),UserModel.instance.userName=decodeURI(egret.getOption("userName").toString()),UserModel.instance.roleName=decodeURI(egret.getOption("roleName")),UserModel.instance.nickName=decodeURI(egret.getOption("nickName")),UserModel.instance.ticket=egret.getOption("ticket"),this.channel=egret.getOption("channel")}egret.Capabilities.runtimeType==egret.RuntimeType.NATIVE},i.changeGameState=function(e){this._gameState!=e&&(this._gameState=e,GameDispatcher.send(GameEvent.GAME_STATE_EVENT))},t(i,"gameState",function(){return this._gameState}),t(i,"moneyType",function(){return this._moneyType},function(e){this._moneyType=e}),t(i,"channel",function(){return this._channel},function(e){this._channel=e}),t(i,"language",function(){return this._language},function(e){this._language=e}),t(i,"clientType",function(){return this._clientType},function(e){this._clientType=e}),t(i,"window",function(){return this._currentWin}),i.openWindow=function(t,n){t==e.instance._currentWin?e.instance._currentWin=null:e.instance._currentWin=t,GameDispatcher.send(GameEvent.WINDOW_EVENT),WindowManager.instance.open(t,n)},i.openAlert=function(e,t,n,i){var s="";switch(e){case 1:s=LanguageConfig.instance.getLanguage("您的余额不足，请前往充值"),t=InterfaceManager.instance.recharge;break;case 2:s=LanguageConfig.instance.getLanguage("您已断开连接，请刷新"),t=InterfaceManager.instance.closeApp;break;case 3:s=LanguageConfig.instance.getLanguage("您的游戏卷不足");break;default:s=e}this.openWindow(Alert,{text:s,okFun:t,cancelFun:n,closeFun:i})},i.onConn=function(){GameDispatcher.send(GameEvent.GAME_NET_CONN)},i.onAssetsComplete=function(e){this._resLoaded=!0,GameDispatcher.send(GameEvent.ASSETS_COMPLETE_EVENT)},i.resLoaded=function(){return this._resLoaded},i.onLiveTick=function(e){},e.heartbeat_interval=1e4,e}();egret.registerClass(ClientModel,"ClientModel");var ConfigModel=function(){function e(){this._pathList=new Array,this._roomList=new Array,this._version="",this._debug=!1,this._isShowLogin=!1,this._showTest=!1,this._showPathPoint=!1,this._fishList=new Array,this._deabedList=new Array,this._createList=new Array,this._shellList=new Array}var t=__define,n=e,i=n.prototype;return t(e,"instance",function(){return null==this._instance&&(this._instance=new e),this._instance}),i.parse=function(e){this._version=e.version,this._showTest=e.showTest,this._showPathPoint=e.showPathPoint,console.log("配置文件:"+this._version),e.debug&&(this._debug="true"==e.debug?!0:!1,this._debug&&(this._isShowLogin=!0),console.log("debug模式:"+this._debug)),GameDispatcher.send(GameEvent.CONFIG_INIT_COMPLETE_EVENT)},i.parseFish=function(e){var t,n=0;for(t in e){var i=new FishVo;i.analysis(e[t]),i.index=n,this._fishList[i.id]=i,n++}},i.parseCreate=function(e){var t;for(t in e.create){var n=new FishCreateVo;n.analysis(e.create[t]),this._createList.push(n)}},i.parseFishPath=function(){var e=this,t=RES.getGroupByName("path");t.forEach(function(t){var n=new egret.ByteArray(RES.getRes(t.name));n.endian=egret.Endian.LITTLE_ENDIAN;for(var i=(n.readUnsignedInt(),n.readUnsignedInt(),n.readUnsignedInt()),s=new Array,a=0;i>a;a++){for(var o=n.readUnsignedInt(),r=new Array,c=0;o>c;c++){var h=new PathPointVo;h.x=n.readFloat()*GameWorld.GAME_WIDTH,h.y=n.readFloat()*GameWorld.GAME_HEIGHT,h.speed=6,r.push(h)}var l,u=[];if(r.length<=3)return void(u=r);for(var c=0;c<r.length-1;c++)if(0==c){u.push(r[0]);var d=new PathPointVo;d.x=r[0].x+(r[0].x-r[1].x)/100,d.y=r[0].y+(r[0].y-r[1].y)/100,l=FishPathUtil.createPath(1,d,r[0],r[1],r[2]),u=u.concat(l)}else{if(c==r.length-2){var p=new PathPointVo;p.x=r[c+1].x+(r[c+1].x-r[c].x)/100,p.y=r[c+1].y+(r[c+1].y-r[c].y)/100,l=FishPathUtil.createPath(u.length,r[c-1],r[c],r[c+1],r[c+1]),u=u.concat(l);break}l=FishPathUtil.createPath(u.length,r[c-1],r[c],r[c+1],r[c+2]),u=u.concat(l)}for(var g=u[0],_=[],c=0;c<u.length;c++){var f=u[c+1];if(null!=f){var m=f.x-g.x,S=f.y-g.y,v=Math.sqrt(m*m+S*S),E=g.speed*m/v,L=g.speed*S/v,C=Math.floor(v/g.speed),y=57*Math.atan2(S,m)+0;0==c&&(g.rotation=y,_.push(g));for(var I=1;C>I;I++){var h=new PathPointVo;h.x=g.x+I*E,h.y=g.y+I*L,h.rotation=y,h.speed=g.speed,_.push(h),I==C-1&&(g=h)}}}s.push(_);for(var T=(n.readFloat(),n.readUnsignedInt()),M=new Array,I=0;T>I;I++)M.push({x:n.readUnsignedInt(),y:n.readUnsignedInt()});for(var A=n.readUnsignedInt(),G=new Array,x=0;A>x;x++)G.push(n.readUTF())}e._pathList.push(s)})},i.parseRoomList=function(e){var t;for(t in e.room){var n=new RoomInfoVo;n.analysis(e.room[t]),this._roomList.push(n)}},i.parseDeabed=function(e){var t;for(t in e.deabed){var n=new DeabedVo;n.analysis(e.deabed[t]),this._deabedList.push(n)}},i.parseGridList=function(e,t,n){this._diceMapGrid=new DiceVo,this._diceMapGrid.analysis(e.Grids),t.apply(n)},i.parseShell=function(e){var t;for(t in e){var n=new ShellVo;n.analysis(e[t]),this._shellList.push(n)}},t(i,"version",function(){return this._version}),t(i,"debug",function(){return this._debug}),t(i,"isShowLogin",function(){return this._isShowLogin}),t(i,"showTest",function(){return this._showTest}),t(i,"fishList",function(){return this._fishList}),t(i,"pathList",function(){return this._pathList}),t(i,"showPathPoint",function(){return this._showPathPoint}),t(i,"roomList",function(){return this._roomList}),t(i,"deabedList",function(){return this._deabedList}),t(i,"createList",function(){return this._createList}),t(i,"diceMapGrid",function(){return this._diceMapGrid}),t(i,"shellList",function(){return this._shellList}),e}();egret.registerClass(ConfigModel,"ConfigModel");var EntityType=function(){function e(){}var t=(__define,e);t.prototype;return e.FISH=10,e.SHELL=11,e}();egret.registerClass(EntityType,"EntityType");var GameStateDef=function(){function e(){}var t=(__define,e);t.prototype;return e.GAME_STATE_ACCOUNT_NULL=0,e.GAME_STATE_LOTTERY=100,e.GAME_STATE_LOTTERY_COMMON=200,e.GAME_STATE_LOTTERY_FREE=250,e.GAME_STATE_JP=300,e.TYPE_COMMON=0,e.TYPE_FREE=1,e}();egret.registerClass(GameStateDef,"GameStateDef");var StateDef=function(){function e(){}var t=(__define,e);t.prototype;return e.IDEL=0,e.ACTIVITY=1,e}();egret.registerClass(StateDef,"StateDef");var HallClientModel=function(){function e(){this._goResult=0,this._pool=0}var t=__define,n=e,i=n.prototype;return t(e,"instance",function(){return null==this._instance&&(this._instance=new e),this._instance}),i.onGoResult=function(e){this._goResult=e.dice,GameDispatcher.send(BaseEvent.DICE_GO_RESULT_EVENT)},i.onDiceInfo=function(e){this._diceInfo=e,GameDispatcher.send(BaseEvent.DICE_INFO_EVENT)},i.onPool=function(e){this._pool=e,GameDispatcher.send(BaseEvent.POOL_EVENT)},t(i,"goResult",function(){return this._goResult}),t(i,"pool",function(){return this._pool}),t(i,"diceInfo",function(){return this._diceInfo}),e}();egret.registerClass(HallClientModel,"HallClientModel");var LanguageConfig=function(){function e(){this.dic=new Object}var t=__define,n=e,i=n.prototype;return t(e,"instance",function(){return null==this._instance&&(this._instance=new e),this._instance}),i.parse=function(e){var t,n,i=e.split("\r\n");for(t in i)""!=i[t]&&(n=i[t].split("	"),this.dic[n[0]]=n[1]);GameDispatcher.send(GameEvent.LANGUAGE_INIT_COMPLETE_EVENT)},i.getLanguage=function(e){return null!=this.dic[e]?this.dic[e]:e},e}();egret.registerClass(LanguageConfig,"LanguageConfig");var UserModel=function(){function e(){this._userName="",this._roleName="",this._nickName="",this._money=0,this._isAnteVoChange=!1}var t=__define,n=e,i=n.prototype;return t(e,"instance",function(){return null==this._instance&&(this._instance=new e),this._instance}),t(i,"ticket",function(){return this._ticket},function(e){this._ticket=e}),t(i,"userName",function(){return this._userName},function(e){this._userName=e,null==this._vo&&(this._vo=new PlayerVo,this._vo.name=this._userName)}),t(i,"roleName",function(){return this._roleName},function(e){this._roleName=e}),t(i,"nickName",function(){return this._nickName},function(e){this._nickName=e}),t(i,"vo",function(){return this._vo}),e}();egret.registerClass(UserModel,"UserModel");var DeabedVo=function(){function e(){this.plant=new Array}var t=(__define,e),n=t.prototype;return n.analysis=function(e){this.id=e.id,this.name=e.name,this.bg=e.bg;var t;for(t in e.plant){var n=new PlantVo;n.analysis(e.plant[t]),this.plant.push(n)}},e}();egret.registerClass(DeabedVo,"DeabedVo");var PlantVo=function(){function e(){}var t=(__define,e),n=t.prototype;return n.analysis=function(e){this.x=e.x,this.y=e.y,this.id=e.id},e}();egret.registerClass(PlantVo,"PlantVo");var DiceInfo=function(){function e(){this.availableTimes=0,this.fishIndex=0}var t=(__define,e);t.prototype;return e}();egret.registerClass(DiceInfo,"DiceInfo");var DiceVo=function(){function e(){this.id=0,this.total=0,this["final"]=0,this.awardMap={},this.girdList=new Array}var t=(__define,e),n=t.prototype;return n.analysis=function(e){this.total=e.total,this["final"]=e["final"];var t,n=0;for(t in e.awardMap)this.awardMap[n]=e.awardMap[n],n++;var i=e.Grid;for(t in i){var s=new GridVo;s.analysis(i[t]),this.girdList.push(s)}},e}();egret.registerClass(DiceVo,"DiceVo");var FishCreateVo=function(){function e(){this.currentCount=0}var t=(__define,e),n=t.prototype;return n.analysis=function(e){this.id=e.id,this.fishType=e.fishType,this.createTime=e.createTime,this.speed=e.speed,this.fishCount=e.fishCount,this.radius=e.radius,this.interval=e.interval,this.pathID=e.pathID},e}();egret.registerClass(FishCreateVo,"FishCreateVo");var FishVo=function(){function e(){this.path=new Array}var t=(__define,e),n=t.prototype;return n.analysis=function(e){this.name=e.name,this.rate=e.rate,this.id=e.id,this.hitTestLevel=e.hitTestLevel;var t,n=0;for(t in e.path){var i=new PathPointVo;i.analysis(e.path[t]),i.index=n,this.path.push(i),n++}},e}();egret.registerClass(FishVo,"FishVo");var GridVo=function(){function e(){this.index=0,this.rewardType=0,this.rewardNum=0,this.offsetX=0,this.offsetY=0,this.x=0,this.y=0}var t=(__define,e),n=t.prototype;return n.analysis=function(e){this.index=parseInt(e.index),this.rewardType=parseInt(e.rewardType),this.rewardNum=parseInt(e.rewardNum),this.offsetX=parseInt(e.offsetX),this.offsetY=parseInt(e.offsetY),this.x=parseInt(e.x),this.y=parseInt(e.y),this.isCover="0"==e.isCover?!1:!0},e}();egret.registerClass(GridVo,"GridVo");var PathPointVo=function(){function e(){}var t=(__define,e),n=t.prototype;return n.analysis=function(e){this.x=e[0],this.y=e[1],this.speed=e[2]},e}();egret.registerClass(PathPointVo,"PathPointVo");var PlayerVo=function(){function e(){this.name="",this.moeny=0,this.cone=0,this.level=0,this.superWeapon=0,this.vipLevel=0,this.gunLevel=0,this.gunCount=0,this.totalExp=10,this.currentExp=0}var t=(__define,e);t.prototype;return e}();egret.registerClass(PlayerVo,"PlayerVo");var RoomInfoVo=function(){function e(){this.list=new Array}var t=(__define,e),n=t.prototype;return n.analysis=function(e){var t=this;this.id=e.id,this.name=e.name,e.list.forEach(function(e){var n=new RoomInfoItemVo;n.analysis(e),t.list.push(n)})},e}();egret.registerClass(RoomInfoVo,"RoomInfoVo");var RoomInfoItemVo=function(){function e(){}var t=(__define,e),n=t.prototype;return n.analysis=function(e){this.index=e.index,this.name=e.name,this.state=e.state,this.desc=e.desc,this.min=e.min},e}();egret.registerClass(RoomInfoItemVo,"RoomInfoItemVo");var ShellVo=function(){function e(){}var t=(__define,e),n=t.prototype;return n.analysis=function(e){this.id=e.id,this.level=e.level,this.shell=e.shell,this.width=e.width,this.height=e.height,this.offx=e.offx,this.offy=e.offy,this.bomb=e.bomb,this.bombWidth=e.bombWidth,this.bombHeight=e.bombHeight,this.bombOffx=e.bombOffx,this.bombOffy=e.bombOffy,this.sendInterval=e.sendInterval,this.speed=e.speed},e}();egret.registerClass(ShellVo,"ShellVo");var BaseEvent=function(){function e(){}var t=(__define,e);t.prototype;return e.LOGIN_RESULT_EVENT="loginResultEvent",e.POOL_EVENT="poolEvent",e.DICE_GO_RESULT_EVENT="GoResultEvent",e.DICE_INFO_EVENT="DiceInfoEvent",e}();egret.registerClass(BaseEvent,"BaseEvent");var GameDispatcher=function(e){function t(){e.call(this,null)}__extends(t,e);var n=__define,i=t;i.prototype;return n(t,"instance",function(){return null==t._instance&&(t._instance=new t),t._instance}),t.send=function(e){e instanceof egret.Event?t.instance.dispatchEvent(e):(null==t.evtMap[e]&&(t.evtMap[e]=new egret.Event(e)),t.instance.dispatchEvent(t.evtMap[e]))},t.addEventListener=function(e,n,i){t.instance.addEventListener(e,n,i)},t.removeEventListener=function(e,n,i){t.instance.removeEventListener(e,n,i)},t.evtMap=new Object,t}(egret.EventDispatcher);egret.registerClass(GameDispatcher,"GameDispatcher");var GameEvent=function(){function e(){}var t=(__define,e);t.prototype;return e.GAME_NET_CONN="gameNetConn",e.GAME_STATE_EVENT="gameStateEvent",e.LOGIN_EVENT="loginEvent",e.CONFIG_INIT_COMPLETE_EVENT="configInitCompleteEvent",e.LANGUAGE_INIT_COMPLETE_EVENT="languageInitCompleteEvent",e.ASSETS_COMPLETE_EVENT="assetsCompleteEvent",e.VIRUAL_INFO_EVENT="virualInfoEvent",e.USER_MONEY_CHANGE="userMoneyChange",e.ANTELIST_CHANGE_EVENT="antelistChangeEvent",e.USER_BET_RANGE_CHANGE="userBetRrangeChange",e.USER_ANTE_CHANGE="userAnteChange",e.BET_EVENT="betEvent",e.LOTTERY_ROLL_RESULT="lotteryRollResult",e.LOTTERY_AUTO_EVENT="lotteryAutoEvent",e.AWARDE_CHANG_EVENT="awardeChangeEvent",e.JP_POOL_CHANGE_EVENT="jpPoolChangeEvent",e.WINDOW_EVENT="windowEvent",e.HELP_DATA_EVENT="helpDataEvent",e.BIGWIN_EVENT="bigWinEvent",e.BIGWIN_SELF_EVENT="bigWinSelfEvent",e.LEVEL_UP_EVENT="levelUpEvent",e}();egret.registerClass(GameEvent,"GameEvent");var GameMain=function(e){function t(){e.call(this),this.popup=WindowManager.instance,this.addEventListener(egret.Event.ADDED_TO_STAGE,this.enter,this),GameDispatcher.addEventListener(GameEvent.ASSETS_COMPLETE_EVENT,this.onAssetsComplete,this),GameDispatcher.addEventListener(GameEvent.WINDOW_EVENT,this.onWindow,this)}__extends(t,e);var n=(__define,t),i=n.prototype;return i.enter=function(e){GameDispatcher.addEventListener(GameEvent.GAME_STATE_EVENT,this.onStateChange,this),this.setDefoult()},i.onAssetsComplete=function(){if(null==this.topBar&&(this.topBar=new TopView),this.addChild(this.topBar),this.topBar.enter(),ConfigModel.instance.showTest){var e=new TestWindow;this.addChild(e),e.enter(this.parent)}},i.onWindow=function(){null==ClientModel.instance.window?this.contains(this.popup)&&(this.removeChild(this.popup),this.popup.exit()):(this.addChild(this.popup),this.popup.enter())},i.setDefoult=function(){ClientModel.instance.changeGameState(new LoginView)},i.exit=function(){},i.execute=function(e){},i.onStateChange=function(e){var t=ClientModel.instance.gameState;this.previousState=this.currentState,null!=this.previousState&&this.previousState.exit(),this.currentState=t,this.currentState.enter(),this.topBar&&this.topBar.execute(t),this.addChild(this.currentState)},t}(egret.Sprite);egret.registerClass(GameMain,"GameMain",["IBase"]);var BaseComponent=function(e){function t(t){void 0===t&&(t=!0),e.call(this),this.skinLoaded=!1,this.isCenter=!1,this.isCenter=t,this.addEventListener(egret.Event.ADDED_TO_STAGE,this.onStage,this),this.addEventListener(eui.UIEvent.COMPLETE,this.onSkinComplete,this)}__extends(t,e);var n=(__define,t),i=n.prototype;return i.onStage=function(e){this.isCenter&&this.center()
},i.onSkinComplete=function(e){this.skinLoaded=!0;try{this.center(),this.initCloseBtn()}catch(t){console.log(t),ClientModel.instance.openWindow(null)}},i.center=function(){null!=this.stage&&(this.x=this.stage.stageWidth-this.width>>1,this.y=this.stage.stageHeight-this.height>>1)},i.initCloseBtn=function(){var e=this;try{this.closeBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.exit&&e.exit()},this)}catch(t){}},t}(eui.Component);egret.registerClass(BaseComponent,"BaseComponent");var DiceGamePanel=function(e){function t(){e.call(this,!1),this.currentGridIndex=0,this.targetGridIndex=0,this.skinName="resource/game_skins/dice/DiceGameSkin.exml",this.touchEnabled=!0,this.touchChildren=!1}__extends(t,e);var n=(__define,t),i=n.prototype;return i.onSkinComplete=function(n){e.prototype.onSkinComplete.call(this,n);var i=RES.getRes("fishDb_json"),s=RES.getRes("texture_json"),a=RES.getRes("texture_png"),o=new dragonBones.EgretFactory;o.addDragonBonesData(dragonBones.DataParser.parseDragonBonesData(i)),o.addTextureAtlas(new dragonBones.EgretTextureAtlas(a,s)),this.armature=o.buildArmature("Armature"),dragonBones.WorldClock.clock.add(this.armature),this.armature.display.x=t.ARMATURE_ZERO_X,this.armature.display.y=t.ARMATURE_ZERO_Y,this.armature.animation.gotoAndPlay("newAnimation"),TimerManager.instance.doLoop(33,this.initDb,this)},i.initDb=function(){dragonBones.WorldClock.clock.advanceTime(.024)},i.init=function(){var e=this,n=ConfigModel.instance.diceMapGrid;n.girdList.forEach(function(t){var i;switch(t.rewardType){case 0:i=MovieclipUtils.createMc("DiceGateBoxMc_png","DiceGateBoxMc_json");break;case 1:i=BitMapUtil.createBitmapByName("diceBox"+n.awardMap[t.rewardNum-1]+"_png");break;default:i=e.createAward(t.rewardType)}try{i.x=t.x,i.y=t.y}catch(s){console.error(s)}e.addChild(i)}),this.armature.display.x=t.ARMATURE_ZERO_X+n.girdList[0].x,this.armature.display.y=t.ARMATURE_ZERO_Y/2+n.girdList[0].y},i.enter=function(e){ConfigModel.instance.parseGridList(RES.getRes("grids_json"),this.init,this),this.addChild(this.armature.display)},i.exit=function(){TimerManager.instance.clearTimer(this.initDb);try{this.armature.dispose()}catch(e){console.error(e)}},i.execute=function(e){this.targetGridIndex=this.currentGridIndex+e[0],this.call=e[1],this.callOwner=e[2],this.goTarget()},i.goTarget=function(){if(this.currentGridIndex<this.targetGridIndex){this.currentGridIndex++;var e=ConfigModel.instance.diceMapGrid.girdList[this.currentGridIndex];this.move(e.x+40,e.y+e.offsetY)}else{var t=ConfigModel.instance.diceMapGrid.awardMap[ConfigModel.instance.diceMapGrid.girdList[this.currentGridIndex].rewardNum-1];ClientModel.instance.openWindow(DiceAlert,"获得"+t+"万能豆奖励")}},i.move=function(e,t){var n=this;egret.Tween.get(this.armature.display,{onChange:function(){n.call.apply(n.callOwner,[e,t])},onChangeObj:this}).to({x:e,y:t},300).call(this.goTarget,this)},i.createAward=function(e){var t;switch(e){case 2:t=BitMapUtil.createBitmapByName("diceAward1_png");break;case 3:t=MovieclipUtils.createMc("diceAward2_png","diceAward2_json");break;case 4:t=BitMapUtil.createBitmapByName("diceAward3_png");break;case 5:t=MovieclipUtils.createMc("diceAward4_png","diceAward4_json");break;case 6:t=BitMapUtil.createBitmapByName("diceAward5_png");break;case 7:t=MovieclipUtils.createMc("diceAward6_png","diceAward6_json")}return t},t.ZERO_POINT_X=145,t.ZERO_POINT_Y=157,t.ARMATURE_ZERO_X=70,t.ARMATURE_ZERO_Y=80,t}(BaseComponent);egret.registerClass(DiceGamePanel,"DiceGamePanel",["IBase"]);var DiceView=function(e){function t(){e.call(this,!1),this.playing=!1,this.skinName="resource/game_skins/dice/DicePanelSkin.exml",this.y=25,this.gameMask=new egret.Sprite,this.gameMask.width=745,this.gameMask.height=355,this.gameMask.graphics.beginFill(0),this.gameMask.graphics.drawRoundRect(0,0,745,355,60,60),this.gameMask.graphics.endFill(),this.gameMask.x=DiceGamePanel.ZERO_POINT_X,this.gameMask.y=DiceGamePanel.ZERO_POINT_Y,this.addChild(this.gameMask),this.game=new DiceGamePanel,this.contentScroller.mask=this.gameMask,this.contentGroup.addChild(this.game),this.contentScroller.viewport=this.contentGroup,this.contentGroup.setLayoutBoundsSize(1500,760),this.bg=BitMapUtil.createBitmapByName("lobbyBg_png"),this.bg.alpha=.8,this.bg.y=14,this.addChildAt(this.bg,0),this.availableTimesText=new egret.BitmapText,this.availableTimesText.font=RES.getRes("dice1_fnt"),this.availableTimesText.width=60,this.availableTimesText.textAlign=egret.HorizontalAlign.CENTER,this.availableTimesText.x=55,this.availableTimesText.y=25,this.availableTimesText.letterSpacing=-20,this.addChild(this.availableTimesText)}__extends(t,e);var n=(__define,t),i=n.prototype;return i.onSkinComplete=function(t){e.prototype.onSkinComplete.call(this,t),this.light=MovieclipUtils.createMc("DiceLightMc_png","DiceLightMc_json"),this.light.gotoAndPlay(1,-1),this.light.x=14,this.addChild(this.light),this.logo=MovieclipUtils.createMc("DiceLogoMc_png","DiceLogoMc_json"),this.logo.gotoAndPlay(1,-1),this.logo.x=146,this.logo.y=17,this.addChild(this.logo),this.goBtn=MovieclipUtils.createMc("DiceGoBtnMc_png","DiceGoBtnMc_json"),this.goBtn.gotoAndPlay(1,-1),this.goBtn.touchEnabled=!0,this.goBtn.x=850,this.goBtn.y=450,this.addChild(this.goBtn),this.paopao=MovieclipUtils.createMc("DicePaoPao_png","DicePaoPao_json"),this.paopao.gotoAndPlay(1,-1),this.paopao.touchEnabled=!1,this.paopao.x=300,this.paopao.y=370,this.addChild(this.paopao),this.diceDoingBtn.selected=!0},i.enter=function(e){this.skinLoaded&&(this.getBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onGetBtn,this),this.infoBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onInfoBtn,this),this.goBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onGoBtn,this)),this.game.enter(),GameDispatcher.addEventListener(BaseEvent.DICE_GO_RESULT_EVENT,this.onGoResult,this),GameDispatcher.addEventListener(BaseEvent.DICE_INFO_EVENT,this.onDiceInfo,this),ConnectionManager.instance.sendHelper.diceInfo()},i.exit=function(){null!=this.parent&&(this.parent.removeChild(this),ClientModel.instance.changeGameState(new HallView)),this.getBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onGetBtn,this),this.infoBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onInfoBtn,this),this.goBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onGoBtn,this),this.game.exit(),this.paopao.stop(),this.logo.stop(),this.goBtn.stop(),this.light.stop()},i.execute=function(e){},i.onGetBtn=function(){ClientModel.instance.openWindow(BindPanel)},i.onInfoBtn=function(){ClientModel.instance.openWindow(HitInfoPanel)},i.onGoBtn=function(){0==this.playing&&(HallClientModel.instance.diceInfo.availableTimes>0?(this.playing=!0,ConnectionManager.instance.sendHelper.diceGo()):ClientModel.instance.openWindow(DiceAlert,"前方路障，完成任务就可以继续拉"))},i.onGoResult=function(){var e=this;null==this.diceMc&&(this.diceMc=MovieclipUtils.createMc("DiceBoxMc_png","DiceBoxMc_json"),this.diceMc.x=300,this.diceMc.y=120,this.diceMc.stop()),this.addChild(this.diceMc),this.diceMc.gotoAndPlay(1,1),this.diceImage=BitMapUtil.createBitmapByName("dice"+HallClientModel.instance.goResult+"_png"),this.diceImage.x=365,this.diceImage.y=402,this.diceImage.scaleX=this.diceImage.scaleY=.85,egret.Tween.get(this).wait(1200).call(function(){e.addChildAt(e.diceImage,e.numChildren-1)},this).wait(990).call(function(){e.diceImage.parent&&e.diceImage.parent.removeChild(e.diceImage),e.diceMc.parent&&e.diceMc.parent.removeChild(e.diceMc),e.playing=!1,e.game.execute([HallClientModel.instance.goResult,e.autoCentering,e])})},i.onDiceInfo=function(){this.availableTimesText.text=HallClientModel.instance.diceInfo.availableTimes.toString()},i.autoCentering=function(e,t){var n,i=0;n=e-350,i=t-167.5,350>n&&(n=0),egret.Tween.get(this.contentGroup).to({scrollH:n},300),167.5>i&&(i=0),egret.Tween.get(this.contentGroup).to({scrollV:i},300)},t}(BaseComponent);egret.registerClass(DiceView,"DiceView",["IBase"]);var DeabedPanel=function(e){function t(){e.call(this),this.bg=new egret.Bitmap,this.touchChildren=this.touchEnabled=!1,this.plantList=new Array,this.config=ConfigModel.instance}__extends(t,e);var n=(__define,t),i=n.prototype;return i.enter=function(e){this.addChildAt(this.bg,0),this.ripple=MovieclipUtils.createMc("wave1_png","wave1_json"),this.ripple.scaleX=GameWorld.GAME_WIDTH/this.ripple.width,this.ripple.scaleY=GameWorld.GAME_HEIGHT/this.ripple.height,this.ripple.alpha=.5,this.addChild(this.ripple),this.execute(!0)},i.exit=function(){this.clreanPlant()},i.execute=function(e){var t=this;if(e){this.clreanPlant();var n=this.config.deabedList[RandomUtil.randInt(0,this.config.deabedList.length-1)];this.playWave(),egret.Tween.get(this.bg).to({alpha:.7},500).call(function(e){t.bg.texture=RES.getRes(e.bg),t.bg.width=GameWorld.GAME_WIDTH,t.bg.height=GameWorld.GAME_HEIGHT,e.plant.forEach(function(e){var n=MovieclipUtils.createMc("plant_"+e.id+"_png","plant_"+e.id+"_json");n.x=e.x,n.y=e.y,t.plantList.push(n),t.addChild(n)})},this,[n]).to({alpha:1},100),this.bg.visible=!0}else this.bg&&(this.bg.visible=!1,this.clreanPlant())},i.clreanPlant=function(){for(;this.plantList.length>0;){var e=this.plantList.pop();e.parent&&e.parent.removeChild(e)}},i.playWave=function(){var e=this;if(null==this.wave){this.wave=BitMapUtil.createBitmapByName("wave_png");var t=Main.STAGE_HEIGHT/this.wave.height;this.wave.scaleX=this.wave.scaleY=t}this.addChild(this.wave),this.wave.x=Main.STAGE_WIDTH,egret.Tween.get(this.wave).to({x:-this.wave.width},1e3).call(function(){e.wave.parent.removeChild(e.wave)},this)},t.bgNameList=["bg2_png","bg3_png","bg4_png","bg6_png","bg7_png","bg8_png","BattleBackground1_png","bg_png","bg1_png"],t}(egret.Sprite);egret.registerClass(DeabedPanel,"DeabedPanel",["IBase"]);var GameWorld=function(e){function t(){e.call(this),t.that=this,this.client=ClientModel.instance,this.client.fishList=new Array,this.createList=new Array,this.client.playerList=new Array,this.bg=new DeabedPanel,this.y=40,this.jpBar=new JpBarPanel,this.jpBar.x=200,this.jpBar.y=70,this.addChild(this.jpBar),this.right=new PlayerList,this.right.x=Main.STAGE_WIDTH-this.right.width,this.addChild(this.right),this.contentSp=new egret.Sprite,this.contentSp.touchChildren=this.contentSp.touchEnabled=!1,this.addChildAt(this.contentSp,0)}__extends(t,e);var n=(__define,t),i=n.prototype;return i.test=function(){for(var e={};this.createList.length<3;){var t=RandomUtil.randInt(0,ConfigModel.instance.createList.length-1);if(!e[t]){e[t]=!0;var n=ConfigModel.instance.createList[t];this.createList.push(n),this.drawPathPoint(ConfigModel.instance.pathList[n.pathID])}}},i.addFish=function(e,n){var i=EntityManager.instance.getAvailableEntity(FishRenderer);i.entityType=EntityType.FISH;var s=ConfigModel.instance.fishList[e];try{s.path=n[RandomUtil.randInt(0,n.length-1)],i.setData(s),t.that.contentSp.addChild(i.getDisplayObject()),i.getFSM().ChangeState(FishStateSeek.instance),t.that.client.fishList.push(i)}catch(a){console.error(a)}},i.enter=function(e){var t=new PlayerGunRenderer(this.contentSp);this.addChild(t),t.enter(),this.client.playerList.push(t),this.addChildAt(this.bg,0),this.bg.enter(!0),this.jpBar.enter(),TimerManager.instance.doOnce(1e3,this.test,this),TimerManager.instance.doFrameLoop(1,this.execute,this),GameDispatcher.addEventListener(TestEvent.ADD_FISH_EVENT,this.addFish,this),GameDispatcher.addEventListener(TestEvent.CHANGE_PATH,this.changePath,this),GameDispatcher.addEventListener(TestEvent.CHANGE_MAP,this.changeMap,this),GameDispatcher.addEventListener(GameEvent.LEVEL_UP_EVENT,this.onLevelUp,this)},i.exit=function(e){null!=this.parent&&this.parent.removeChild(this),this.bg.exit(),this.jpBar.exit(),TimerManager.instance.clearTimer(this.test),TimerManager.instance.clearTimer(this.execute),GameDispatcher.removeEventListener(TestEvent.ADD_FISH_EVENT,this.addFish,this),GameDispatcher.removeEventListener(TestEvent.CHANGE_PATH,this.changePath,this),GameDispatcher.removeEventListener(TestEvent.CHANGE_MAP,this.changeMap,this)},i.execute=function(){var e=this;this.createList.forEach(function(t){t.currentCount<t.fishCount?egret.getTimer()-t.createTime>t.interval&&(t.createTime=egret.getTimer(),t.currentCount++,e.addFish(t.fishType,ConfigModel.instance.pathList[t.pathID])):(t.currentCount=0,delete e.createList[e.createList.indexOf(t)])}),this.client.fishList.forEach(function(e){0==e.isDestroy&&e.getFSM().Update()}),this.client.playerList.forEach(function(e){e.execute()})},i.changePath=function(){this.graphics.clear(),this.createList=[],this.test()},i.drawPathPoint=function(e){var t=this;if(ConfigModel.instance.showPathPoint){this.bg&&this.bg.execute(!1);var n=0;e.forEach(function(e){var i=0;e.forEach(function(e){t.graphics.beginFill(n,.8),t.graphics.drawCircle(e.x,e.y,2),t.graphics.endFill(),i++}),n+=17})}},i.changeMap=function(){this.bg.execute(!0),this.graphics.clear()},i.onLevelUp=function(){ClientModel.instance.openWindow(LevelUpPanel)},t.GAME_WIDTH=730,t.GAME_HEIGHT=530,t}(egret.Sprite);egret.registerClass(GameWorld,"GameWorld",["IBase"]);var HitGoldAnimation=function(){function e(){this.goldList=new Array}var t=__define,n=e,i=n.prototype;return t(e,"instance",function(){return null==this._instance&&(this._instance=new e),this._instance}),i.enter=function(e){for(var t=e.target,n=(e.money,1);7>n;n++){var i=MovieclipUtils.createMc("hitAwardGold_png","hitAwardGold_json");i.x=e.x,i.y=e.y,i.gotoAndPlay(1,-1),t.parent.addChild(i),egret.Tween.get(i).to({y:e.y-60+50*parseInt((n-1)/3+""),x:e.x-60+50*parseInt(n%3+"")},150).wait(400+50*n).to({x:t.x+190,y:t.y+65},200).call(function(e){e.stop(),e.parent?e.parent.removeChild(e):console.error("parent is null")},this,[i])}},i.exit=function(){},i.execute=function(e){},e}();egret.registerClass(HitGoldAnimation,"HitGoldAnimation",["IBase"]);var JpBarPanel=function(e){function t(){e.call(this,!1),this.touchChildren=!1,this.poolText=new egret.BitmapText,this.poolText.font=RES.getRes("hallPool_fnt"),this.poolText.width=240,this.poolText.x=50,this.poolText.y=20,this.poolText.textAlign=egret.HorizontalAlign.CENTER,this.skinName="resource/game_skins/JpBarSkin.exml"}__extends(t,e);var n=(__define,t),i=n.prototype;return i.onSkinComplete=function(t){e.prototype.onSkinComplete.call(this,t),this.addChild(this.poolText)},i.enter=function(e){this.flash=MovieclipUtils.createMc("jpBarFlashMc_png","jpBarLightMc_json"),this.flash.gotoAndPlay(1,-1),this.flash.scaleX=this.flash.scaleY=.65,this.flash.x=100,this.flash.y=12,this.addChild(this.flash),this.mc=MovieclipUtils.createMc("jpBarLightMc_png","jpBarLightMc_json"),this.mc.gotoAndPlay(1,-1),this.mc.x=42,this.addChild(this.mc),this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTap,this),GameDispatcher.addEventListener(BaseEvent.POOL_EVENT,this.changePool,this)},i.exit=function(){ClientModel.instance.openWindow(null),GameDispatcher.removeEventListener(BaseEvent.POOL_EVENT,this.changePool,this)},i.execute=function(e){},i.init=function(){},i.destroy=function(){},i.onTap=function(){ClientModel.instance.openWindow(RankPanel)},i.changePool=function(){this.poolText.text=StringUtils.numSection(HallClientModel.instance.pool)},t}(BaseComponent);egret.registerClass(JpBarPanel,"JpBarPanel",["IBase"]);var PlayerList=function(e){function t(){e.call(this,!1),this.skinName="resource/game_skins/RightPanelSkin.exml",this.touchChildren=!1}__extends(t,e);var n=(__define,t),i=n.prototype;return i.onSkinComplete=function(t){e.prototype.onSkinComplete.call(this,t)},i.enter=function(e){},i.exit=function(){ClientModel.instance.openWindow(null)},i.execute=function(e){},t}(BaseComponent);egret.registerClass(PlayerList,"PlayerList",["IBase"]);var HallView=function(e){function t(){e.call(this,!1),this.dataArray=new eui.ArrayCollection,this.dataArray.addItem({id:0,image:"lobbyRoomBtnbg1_png"}),this.dataArray.addItem({id:1,image:"lobbyRoomBtnbg2_png"}),this.dataArray.addItem({id:2,image:"lobbyRoomBtnbg3_png"}),this.dataArray.addItem({id:3,image:"lobbyRoomBtnbg4_png"}),this.skinName="resource/game_skins/LabbySkin.exml",this.touchEnabled=!1,this.y=40}__extends(t,e);var n=(__define,t),i=n.prototype;return i.onSkinComplete=function(t){e.prototype.onSkinComplete.call(this,t),this.listScroller.bounces=!1;var n=new eui.HorizontalLayout;n.gap=50,this.roomList.layout=n,this.roomList.itemRenderer=RoomBtnItemRenderer,this.roomList.dataProvider=this.dataArray;var n=new eui.HorizontalLayout;n.gap=5,n.horizontalAlign=egret.HorizontalAlign.RIGHT,n.verticalAlign=egret.VerticalAlign.BOTTOM,n.paddingBottom=10,n.paddingRight=10,this.tabBar.layout=n,this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTap,this),this.roomList.addEventListener(eui.ItemTapEvent.ITEM_TAP,this.onItemTap,this)},i.enter=function(e){egret.Capabilities.isMobile||(this.lightMc=MovieclipUtils.createMc("lightMc_png","lightMc_json"),this.lightMc.play(-1),this.lightMc.scaleX=this.lightMc.scaleY=2,this.lightMc.alpha=.9,this.addChildAt(this.lightMc,1),this.paopao=MovieclipUtils.createMc("paopao_png","paopao_json"),this.paopao.play(-1),this.paopao.x=300,this.paopao.y=Main.STAGE_HEIGHT-200,this.addChildAt(this.paopao,1)),this.qpMc=MovieclipUtils.createMc("qiPaoMc_png","qiPaoMc_json"),this.qpMc.play(-1),this.qpMc.x=300,this.qpMc.y=400,this.addChildAt(this.qpMc,1),this.jpText=new egret.BitmapText,this.jpText.font=RES.getRes("hallPool_fnt"),this.jpText.x=180,this.jpText.y=35,this.jpText.width=210,this.jpText.textAlign=egret.HorizontalAlign.CENTER,this.addChild(this.jpText),TimerManager.instance.doLoop(2e3,this.changePage,this),GameDispatcher.addEventListener(BaseEvent.POOL_EVENT,this.changePool,this)},i.exit=function(){null!=this.parent&&this.parent.removeChild(this),this.lightMc&&this.lightMc.stop(),this.qpMc.stop(),this.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTap,this),this.roomList.removeEventListener(eui.ItemTapEvent.ITEM_TAP,this.onItemTap,this),TimerManager.instance.clearTimer(this.changePage),GameDispatcher.removeEventListener(BaseEvent.POOL_EVENT,this.changePool,this)},i.execute=function(e){},i.onItemTap=function(e){this.showRoomInfoListPanel(ConfigModel.instance.roomList[this.roomList.selectedItem.id])},i.onTap=function(e){switch(e.target.name,e.target){case this.diceBtn:ClientModel.instance.changeGameState(LoadingUI.instance),LoadingUI.instance.enter("resource/game_skins/LoadRoomSkin.exml"),LoadingUI.instance.loadAssets(function(){ClientModel.instance.changeGameState(new DiceView)},LoadingUI.assets3);break;case this.jpBtn:ClientModel.instance.openWindow(RankPanel);break;case this.pBtn:this.roomList.scrollH>0&&(this.roomList.validateNow(),egret.Tween.get(this.roomList).to({scrollH:this.roomList.scrollH-280},300),this.roomList.scrollH<0&&(this.roomList.scrollH=0));break;case this.nBtn:this.roomList.scrollH<558&&(this.roomList.validateNow(),egret.Tween.get(this.roomList).to({scrollH:this.roomList.scrollH+230+50},300),this.roomList.scrollH>558&&(this.roomList.scrollH=558))}},i.showRoomInfoListPanel=function(e){null==this.roomInfoPanel&&(this.roomInfoPanel=new RoomInfoListPanel),this.addChild(this.roomInfoPanel),this.roomInfoPanel.enter(e)},i.changePage=function(){this.tabBar.selectedIndex>=this.tabBar.numElements-1?this.tabBar.selectedIndex=0:this.tabBar.selectedIndex=this.tabBar.selectedIndex+1,this.viewStack.selectedIndex=this.tabBar.selectedIndex},i.changePool=function(){this.jpText.text=StringUtils.numSection(HallClientModel.instance.pool)},t}(BaseComponent);egret.registerClass(HallView,"HallView",["IBase"]);var RoomInfoListPanel=function(e){function t(){e.call(this,!1);var t=new egret.Sprite;t.graphics.beginFill(0,0),t.graphics.drawRect(-207,-155,Main.STAGE_WIDTH,Main.STAGE_HEIGHT),t.graphics.endFill(),this.addChild(t),this.skinName="resource/game_skins/LabbyRoomInfoListSkin.exml",this.collection=new eui.ArrayCollection}__extends(t,e);var n=(__define,t),i=n.prototype;return i.onSkinComplete=function(t){e.prototype.onSkinComplete.call(this,t),this.dataList.itemRenderer=RoomInfoListRenderer,this.x=(Main.STAGE_WIDTH-this.width)/3,this.y=Main.STAGE_HEIGHT-this.height>>1},i.enter=function(e){var t=this,n=e;this.skinLoaded&&(this.closeBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onCloseBtn,this),this.dataList.addEventListener(eui.ItemTapEvent.ITEM_TAP,this.onSelect,this),this.collection.removeAll(),n.list.forEach(function(e){t.collection.addItem(e)}),this.dataList.dataProvider=this.collection)},i.exit=function(){null!=this.parent&&this.parent.removeChild(this),this.closeBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onCloseBtn,this)},i.execute=function(e){},i.onCloseBtn=function(){this.exit()},i.onSelect=function(e){1==this.dataList.selectedItem.state?(HallClientModel.instance.selectRoomIndex=this.dataList.selectedItem,ClientModel.instance.changeGameState(LoadingUI.instance),LoadingUI.instance.enter("resource/game_skins/LoadRoomSkin.exml"),LoadingUI.instance.loadAssets(function(){ClientModel.instance.changeGameState(new GameWorld)},LoadingUI.assets2)):console.log("敬请期待")},t}(BaseComponent);egret.registerClass(RoomInfoListPanel,"RoomInfoListPanel",["IBase"]);var LoadingUI=function(e){function t(){e.call(this),this.current=0,this.total=0,this.addEventListener(eui.UIEvent.COMPLETE,this.onSkinComplete,this),this.enter("resource/game_skins/LoadSkin.exml"),this.y=40}__extends(t,e);var n=__define,i=t,s=i.prototype;return s.createChildren=function(){e.prototype.createChildren.call(this)},s.onSkinComplete=function(n){e.prototype.onSkinComplete.call(this,n),t.instance.removeEventListener(eui.UIEvent.COMPLETE,this.onSkinComplete,this),t.instance.onConfigComplete(),t.instance.tempText.text="当前加载进度：\n总进度："},n(t,"instance",function(){return null==t._instance&&(t._instance=new t),t._instance}),s.loadAssets=function(e,t){null!=e&&(this.callBack=e,this.total=t.length,this.assetsList=t),this.load()},s.load=function(){if(t.instance.assetsList.length>0){var e=t.instance.assetsList.shift();RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onError,this),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.loadGroup(e),t.instance.current++}else RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onComplete,this),RES.removeEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onError,this),RES.removeEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),this.tempText&&(this.tempText.text="资源加载完毕！"),null!=this.callBack&&this.callBack(),this.exit(),ClientModel.instance.onAssetsComplete()},s.onComplete=function(e){t.instance.load(),"config"==e.groupName&&(ConfigModel.instance.parse(RES.getRes("game_json")),ConfigModel.instance.parseFish(RES.getRes("fish_json")),ConfigModel.instance.parseCreate(RES.getRes("create_json")),ConfigModel.instance.parseRoomList(RES.getRes("room_json")),ConfigModel.instance.parseDeabed(RES.getRes("deabed_json")),ConfigModel.instance.parseShell(RES.getRes("shell_json"))),"path"==e.groupName&&ConfigModel.instance.parseFishPath()},s.onError=function(e){console.error("加载资源遇到错误")},s.onResourceProgress=function(e){t.instance.setProgress(e.itemsLoaded,e.itemsTotal)},s.setProgress=function(e,n){null!=t.instance.tempText&&(t.instance.tempText.text="当前加载进度：["+Math.floor(e/n*100)+"/100]\n总进度：["+t.instance.current+"/"+t.instance.total+"]"),t.instance.bar&&(t.instance.bar.value=e,t.instance.bar.maximum=n)},s.onConfigComplete=function(e){null!=t.instance.versionText&&(t.instance.versionText.text="程序版本："+Main.VERSION+"\n配置文件："+ConfigModel.instance.version)},s.changTip=function(e){},s.enter=function(e){this.skinName=e,GameDispatcher.addEventListener(GameEvent.CONFIG_INIT_COMPLETE_EVENT,this.onConfigComplete,this),this.changTip(this),TimerManager.instance.doLoop(2e3,this.changTip,this)},s.exit=function(e){TimerManager.instance.clearTimer(this.changTip),RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onComplete,this),RES.removeEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onError,this),RES.removeEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),GameDispatcher.instance.removeEventListener(GameEvent.CONFIG_INIT_COMPLETE_EVENT,this.onConfigComplete,this),null!=this.parent&&this.parent.removeChild(this)},s.execute=function(e){},t.tipList=["抵制不良游戏，拒绝盗版游戏","注意自我保护，谨防受骗上当","适度游戏益脑，沉迷游戏伤身","合理安排时间，享受健康生活"],t.assets1=["config","loading","labby","alert","top","font"],t.assets2=["fish","player","bg","bgPlant","fish1","jpBar","shell","path"],t.assets3=["dice","diceWindow"],t}(BaseComponent);egret.registerClass(LoadingUI,"LoadingUI",["IBase"]);var LoginView=function(e){function t(){e.call(this),t.that=this;var n=new egret.Sprite;n.graphics.beginFill(1118465),n.graphics.drawRect(0,0,Main.STAGE_WIDTH,Main.STAGE_HEIGHT),n.width=Main.STAGE_WIDTH,n.height=Main.STAGE_HEIGHT,n.graphics.endFill(),n.touchEnabled=!0,this.addChild(n),this.nameTip=new egret.TextField,this.nameTip.text="用户名：",this.addChild(this.nameTip),this.nameTip.x=100,this.nameTip.y=200,this.nameText=new egret.TextField,this.nameText.type=egret.TextFieldType.INPUT,this.nameText.x=this.nameTip.x+this.nameTip.width,this.nameText.y=this.nameTip.y,this.nameText.width=200,this.nameText.text="#ogtest00"+RandomUtil.randInt(0,9)+RandomUtil.randInt(0,9),this.nameText.border=!0,this.nameText.background=!0,this.nameText.backgroundColor=0,this.addChild(this.nameText);var i=new egret.TextField;i.text="捕鱼",this.addChild(i),i.size=50,i.x=this.nameTip.x,i.y=this.nameTip.y-100;var s=new egret.TextField;s.text="点击屏幕登陆游戏",s.size=20,s.x=this.nameTip.x,s.y=this.nameTip.y+200,s.textColor=65793,this.addChild(s),egret.Tween.get(n).to({alpha:.1},15e3),n.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTap,this)}__extends(t,e);var n=(__define,t),i=n.prototype;return i.enter=function(e){GameDispatcher.addEventListener(BaseEvent.LOGIN_RESULT_EVENT,this.onLoginResult,this)},i.exit=function(){null!=t.that.parent&&t.that.parent.removeChild(t.that),UserModel.instance.userName=this.nameText.text},i.execute=function(e){},i.onTap=function(){UserModel.instance.userName=this.nameText.text,ConnectionManager.instance.sendHelper.login()},i.onLoginResult=function(){ClientModel.instance.changeGameState(LoadingUI.instance),LoadingUI.instance.loadAssets(function(){ClientModel.instance.changeGameState(new HallView)},LoadingUI.assets1)},t}(egret.Sprite);egret.registerClass(LoginView,"LoginView",["IBase"]);var FishRenderer=function(e){function t(){e.call(this),this.pathStep=0,this.pathList=new Array,this.clientPathList=new Array,this.stateMachine=new StateMachine(this)}__extends(t,e);var n=(__define,t),i=n.prototype;return i.updateHitBox=function(e,t){},i.update=function(){this.getFSM().Update()},i.handleMessage=function(e){},i.getFSM=function(){return this.stateMachine},i.getDisplayObject=function(){return this.displayObject},i.setData=function(e){this.setMc(e.id),this.vo=e,this.pathList=e.path,this.name=e.name,this.pathStep=0,this.speedX=0,this.speedY=0,this.clientPathList=[]},i.setMc=function(e){var t,n=RES.getRes("fish"+e+"_json"),i=RES.getRes("fish"+e+"_png"),s=new egret.MovieClipDataFactory(n,i);t=new egret.MovieClip(s.generateMovieClipData()),t.stop(),t.rotation=180,t.anchorOffsetX=t.width>>1,t.anchorOffsetY=t.height>>1,t.play(-1),t.touchEnabled=!1,this.displayObject=t},i.getDataVo=function(e){var t;return t=this.vo},t}(BaseMovingEntity);egret.registerClass(FishRenderer,"FishRenderer",["IMovingEneity","IBaseGameEntity"]);var PlayerGunRenderer=function(e){function t(t){e.call(this,!1),this.lastSendTime=0,this.shellContent=t,this.skinName="resource/renderer/PlayerGun.exml",this.shellList=new Array}__extends(t,e);var n=(__define,t),i=n.prototype;return i.onSkinComplete=function(t){e.prototype.onSkinComplete.call(this,t),this.y=Main.STAGE_HEIGHT-this.height-40,this.x=100,this.robot=MovieclipUtils.createMc("robot_png","robot_json"),this.robot.x=145,this.robot.y=80,this.robot.gotoAndStop(1),this.robot.anchorOffsetX=35,this.robot.anchorOffsetY=38,this.addChild(this.robot)},i.enter=function(e){this.data=UserModel.instance.vo,this.shellVo=0==this.data.gunLevel?ConfigModel.instance.shellList[1]:ConfigModel.instance.shellList[this.data.gunLevel],this.skinLoaded&&this.fillData(),this.centerPoint=this.localToGlobal(this.robot.x,this.robot.y),this.position=new Vector2Ds(this.centerPoint.x,this.centerPoint.y-50),this.addEventListener(egret.Event.ADDED_TO_STAGE,this.onAdd,this),this.robot.filters=[new egret.ColorMatrixFilter(MatrixUtils.change)]},i.exit=function(){},i.execute=function(e){null!=this.touchEvt&&(this.onMove(this.touchEvt),egret.getTimer()-this.lastSendTime>this.shellVo.sendInterval&&this.fire()),this.shellList.forEach(function(e){e.getFSM().Update()})},i.onAdd=function(){this.stage.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onBegin,this),this.stage.addEventListener(egret.TouchEvent.TOUCH_END,this.onEnd,this)},i.onBegin=function(e){this.touchEvt=e},i.onEnd=function(e){this.touchEvt=null},i.onMove=function(e){var t=e.stageY-this.centerPoint.y;t>-1&&(t=-1);var n=e.stageX-this.centerPoint.x;this.robot.rotation=57*Math.atan2(t,n)},i.fire=function(){this.robot.gotoAndPlay(1,1);var e=this.getIdelShell();e.position=this.position,e.getFSM().ChangeState(ShellMovingEntityStateSeek.instance),e.rotation=this.robot.rotation,this.data.gunCount--,this.shellContent.addChild(e.displayObject),this.lastSendTime=egret.getTimer()},i.getIdelShell=function(){var e=EntityManager.instance.getAvailableEntity(ShellRenderer);return e.setData(this.shellVo),e.owner=this,this.shellList[e.sid]=e,e},i.clearnShell=function(e){delete this.shellList[e]},i.fillData=function(){this.nameText.text=this.data.name,this.lvText.text="LV:"+this.data.level,this.lvBar.maximum=this.data.totalExp,this.lvBar.minimum=0},i.updateData=function(){this.skinLoaded&&(this.lvBar.value=this.data.currentExp,this.gunText.text=this.data.gunCount.toString(),this.moneyText.text=this.data.moeny.toString(),this.lvText.text=this.data.level.toString(),this.shellVo=0==this.data.level?ConfigModel.instance.shellList[1]:ConfigModel.instance.shellList[this.data.gunLevel])},i.killFish=function(e){this.data.currentExp++,this.data.currentExp>this.data.totalExp&&(this.data.currentExp=0,this.data.level++,this.data.totalExp=this.data.totalExp+5*this.data.level,this.lvBar.maximum=this.data.totalExp,this.lvBar.minimum=0,GameDispatcher.send(GameEvent.LEVEL_UP_EVENT)),this.data.moeny+=e.rate,this.updateData()},t}(BaseComponent);egret.registerClass(PlayerGunRenderer,"PlayerGunRenderer",["IBase"]);var RoomBtnItemRenderer=function(e){function t(){e.call(this),this.addEventListener(eui.UIEvent.COMPLETE,this.onSkinComplete,this),this.skinName="resource/renderer/RoomItenSkin.exml"}__extends(t,e);var n=(__define,t),i=n.prototype;return i.onSkinComplete=function(e){},i.dataChanged=function(){this.bgImage.source=this.data.image,this.mc=MovieclipUtils.createMc("lobbyWareMc_png","lobbyWareMc_json"),this.mc.x=40,this.addChildAt(this.mc,0)},t}(eui.ItemRenderer);egret.registerClass(RoomBtnItemRenderer,"RoomBtnItemRenderer");var RoomInfoListRenderer=function(e){function t(){e.call(this),this.addEventListener(eui.UIEvent.COMPLETE,this.onSkinComplete,this),this.skinName="resource/renderer/HallRoomInfoListItemSkin.exml"}__extends(t,e);var n=(__define,t),i=n.prototype;return i.onSkinComplete=function(e){this.conText=new egret.TextField,this.conText.x=this.infoText.x,this.conText.y=this.infoText.y,this.conText.width=this.infoText.width,this.conText.height=this.infoText.height,this.conText.size=this.infoText.size,this.conText.textColor=this.infoText.textColor,this.conText.lineSpacing=3,this.addChild(this.conText)},i.dataChanged=function(){var e=this.data;0==e.state?this.conText.text="敬请期待":this.conText.textFlow=(new egret.HtmlTextParser).parser("<font>"+e.name+"\n"+e.desc+"\n准入值"+e.min+"</font>")},t}(eui.ItemRenderer);egret.registerClass(RoomInfoListRenderer,"RoomInfoListRenderer");var ShellRenderer=function(e){function t(){e.call(this),this.stateMachine=new StateMachine(this),this.testBox=new egret.Sprite}__extends(t,e);var n=(__define,t),i=n.prototype;return i.setData=function(e){this.data=e,this.hitBox.width=e.width,this.hitBox.height=e.height,this.speed=e.speed,this.testBox.graphics.drawRect(e.offx,e.offy,e.width,e.height),this.displayObject&&this.displayObject.parent&&this.displayObject.parent.removeChild(this.displayObject),this.mcf=MovieclipUtils.getFactory(e.shell+"_png",e.shell+"_json"),this.displayObject=new egret.MovieClip(this.mcf.generateMovieClipData(this.data.shell)),this.displayObject.anchorOffsetX=this.displayObject.width>>1,this.displayObject.anchorOffsetY=this.displayObject.height>>1,this.entityType=EntityType.SHELL
},i.updateHitBox=function(e,t){this.hitBox.x=e+this.data.offx,this.hitBox.y=t+this.data.offy},i.update=function(){},i.handleMessage=function(e){},i.getFSM=function(){return this.stateMachine},i.getDisplayObject=function(){return this.displayObject},i.getDataVo=function(e){},t}(BaseMovingEntity);egret.registerClass(ShellRenderer,"ShellRenderer",["IMovingEneity","IBaseGameEntity"]);var TopView=function(e){function t(){e.call(this,!1),this.skinName="resource/game_skins/TopSkin.exml",this.roomListData=new eui.ArrayCollection}__extends(t,e);var n=(__define,t),i=n.prototype;return i.onSkinComplete=function(t){e.prototype.onSkinComplete.call(this,t),this.roomList.visible=!1,this.bgImage.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onRoomBgTap,this),this.roomList.addEventListener(eui.ItemTapEvent.ITEM_TAP,this.onSelectRoom,this),this.userMoneyText.font=RES.getRes("sy1_fnt")},i.enter=function(e){this.skinLoaded&&(this.exitBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onExit,this),this.operationBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onOperation,this),this.helpBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onHelp,this),this.autoBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onAuto,this),this.mailBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onMail,this),this.rechargeBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onRechargel,this),this.execute(ClientModel.instance.gameState),this.userMoneyText.text=UserModel.instance.vo.moeny.toString())},i.exit=function(){this.exitBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onExit,this),this.operationBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onOperation,this),this.autoBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onAuto,this)},i.execute=function(e){if(e instanceof HallView)this.exitBtn.visible=!1,this.autoBtn.visible=!1,this.userInfo.visible=!1,this.roomInfo.visible=!1,this.bugGunBtn.visible=!1,this.lockBtn.visible=!1;else if(e instanceof GameWorld){this.exitBtn.visible=!0,this.autoBtn.visible=!0,this.userInfo.visible=!0,this.roomInfo.visible=!0,this.bugGunBtn.visible=!0,this.lockBtn.visible=!0,this.roomNameText.text=HallClientModel.instance.selectRoomIndex.name;var t;for(t in ConfigModel.instance.roomList){var n;for(n in ConfigModel.instance.roomList[t].list)1==ConfigModel.instance.roomList[t].list[n].state&&this.roomListData.addItem(ConfigModel.instance.roomList[t].list[n].name)}this.roomList.dataProvider=this.roomListData}},i.onExit=function(){ClientModel.instance.openAlert("确定要退出吗？",function(){ClientModel.instance.changeGameState(new HallView)})},i.onRoomBgTap=function(e){e instanceof egret.TouchEvent&&(e.stopImmediatePropagation(),e.stopPropagation()),this.roomList.visible=!this.roomList.visible,this.roomList.visible?this.stage.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onRoomBgTap,this):this.stage.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onRoomBgTap,this)},i.onSelectRoom=function(e){this.onRoomBgTap()},i.onOperation=function(){ClientModel.instance.openWindow(OperationPanel)},i.onHelp=function(){ClientModel.instance.openWindow(HelpPanel)},i.onMail=function(){ClientModel.instance.openWindow(MailPanel)},i.onRechargel=function(){InterfaceManager.instance.recharge()},i.onAuto=function(){},i.onData=function(){},t}(BaseComponent);egret.registerClass(TopView,"TopView",["IBase"]);var Alert=function(e){function t(){e.call(this),this.isShow=!1,this.skinName="resource/game_skins/window/AlertSkin.exml",this.init()}__extends(t,e);var n=(__define,t),i=n.prototype;return i.enter=function(e){0==this.isShow&&(this.isShow=!0,this.info=WindowManager.instance.alertDataList.shift(),null!=this.info?(this.alpha=1,this.contentText.text=this.info.text):(this.isShow=!1,ClientModel.instance.openWindow(null)),this.okBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onOkBtn,this),this.returnBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onReturnBtn,this))},i.execute=function(e){},i.onShowComplete=function(){this.isShow=!1,WindowManager.instance.alertDataList.length>0?this.enter():ClientModel.instance.openWindow(null)},i.exit=function(e){this.contentText.text="",TimerManager.instance.clearTimer(ClientModel.instance.openWindow),ClientModel.instance.openWindow(null),this.isShow=!1},i.destroy=function(){this.exit()},i.init=function(){this.bg=new egret.Sprite,this.bg.graphics.beginFill(16777215,0),this.bg.graphics.drawRect(0,0,Main.STAGE_WIDTH,Main.STAGE_HEIGHT),this.bg.graphics.endFill(),this.addChildAt(this.bg,0)},i.onOkBtn=function(){this.info&&this.info.okFun&&this.info.okFun(),this.exit()},i.onReturnBtn=function(){this.info&&this.info.canelFun&&this.info.canelFun(),this.exit()},t.SHOW_TIME=2500,t}(BaseComponent);egret.registerClass(Alert,"Alert",["IWindow","IBase"]);var BindPanel=function(e){function t(){e.call(this),this.skinName="resource/game_skins/window/DiceBindPanelSkin.exml"}__extends(t,e);var n=(__define,t),i=n.prototype;return i.onSkinComplete=function(t){e.prototype.onSkinComplete.call(this,t)},i.enter=function(e){},i.exit=function(){ClientModel.instance.openWindow(null)},i.execute=function(e){},i.init=function(){},i.destroy=function(){},t}(BaseComponent);egret.registerClass(BindPanel,"BindPanel",["IWindow","IBase"]);var DiceAlert=function(e){function t(){e.call(this),this.skinName="resource/game_skins/window/DiceAlertSkin.exml"}__extends(t,e);var n=(__define,t),i=n.prototype;return i.onSkinComplete=function(t){e.prototype.onSkinComplete.call(this,t)},i.enter=function(e){console.log(e),this.contentText.text=e},i.exit=function(){ClientModel.instance.openWindow(null)},i.execute=function(e){},i.init=function(){},i.destroy=function(){},t}(BaseComponent);egret.registerClass(DiceAlert,"DiceAlert",["IBase"]);var HelpPanel=function(e){function t(){e.call(this),this.skinName="resource/game_skins/window/HelpPanelSkin.exml"}__extends(t,e);var n=(__define,t),i=n.prototype;return i.onSkinComplete=function(t){e.prototype.onSkinComplete.call(this,t)},i.enter=function(e){this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTap,this)},i.exit=function(e){null!=this.stage&&this.stage.removeEventListener(egret.TouchEvent.TOUCH_END,this.exit,this),ClientModel.instance.openWindow(null)},i.execute=function(e){},i.init=function(){},i.destroy=function(){},i.onTap=function(e){if(e.target instanceof eui.Button)switch(e.target){case this.btn1:break;case this.btn2:break;case this.btn3:break;case this.btn4:break;case this.btn5:break;case this.btn6:break;case this.btn7:}},t}(BaseComponent);egret.registerClass(HelpPanel,"HelpPanel",["IWindow","IBase"]);var HitInfoPanel=function(e){function t(){e.call(this),this.skinName="resource/game_skins/window/DiceHitInfoPanelSkin.exml"}__extends(t,e);var n=(__define,t),i=n.prototype;return i.onSkinComplete=function(t){e.prototype.onSkinComplete.call(this,t)},i.enter=function(e){},i.exit=function(){ClientModel.instance.openWindow(null)},i.execute=function(e){},i.init=function(){},i.destroy=function(){},t}(BaseComponent);egret.registerClass(HitInfoPanel,"HitInfoPanel",["IWindow","IBase"]);var LevelUpPanel=function(e){function t(){e.call(this),this.skinName="resource/game_skins/window/LevelUpSkin.exml"}__extends(t,e);var n=(__define,t),i=n.prototype;return i.onSkinComplete=function(t){e.prototype.onSkinComplete.call(this,t)},i.enter=function(e){this.levelText.text=UserModel.instance.vo.level.toString(),TimerManager.instance.doOnce(2e3,this.exit,this)},i.exit=function(){ClientModel.instance.openWindow(null)},i.execute=function(e){},i.init=function(){},i.destroy=function(){},t}(BaseComponent);egret.registerClass(LevelUpPanel,"LevelUpPanel",["IWindow","IBase"]);var MailPanel=function(e){function t(){e.call(this),this.skinName="resource/game_skins/window/MailPanelSkin.exml"}__extends(t,e);var n=(__define,t),i=n.prototype;return i.onSkinComplete=function(t){e.prototype.onSkinComplete.call(this,t)},i.enter=function(e){},i.exit=function(){ClientModel.instance.openWindow(null)},i.execute=function(e){},i.init=function(){},i.destroy=function(){},t}(BaseComponent);egret.registerClass(MailPanel,"MailPanel",["IWindow","IBase"]);var OperationPanel=function(e){function t(){e.call(this),this.skinName="resource/game_skins/window/SettingPanelSkin.exml"}__extends(t,e);var n=(__define,t),i=n.prototype;return i.onSkinComplete=function(t){e.prototype.onSkinComplete.call(this,t)},i.enter=function(e){},i.exit=function(){ClientModel.instance.openWindow(null)},i.execute=function(e){},i.init=function(){},i.destroy=function(){},t}(BaseComponent);egret.registerClass(OperationPanel,"OperationPanel",["IWindow","IBase"]);var RankPanel=function(e){function t(){e.call(this),this.skinName="resource/game_skins/window/RankPanelSkin.exml"}__extends(t,e);var n=(__define,t),i=n.prototype;return i.onSkinComplete=function(t){e.prototype.onSkinComplete.call(this,t),this.kBtn.selected=!0},i.enter=function(e){},i.exit=function(){ClientModel.instance.openWindow(null)},i.execute=function(e){},i.init=function(){},i.destroy=function(){},t}(BaseComponent);egret.registerClass(RankPanel,"RankPanel",["IWindow","IBase"]);var WindowManager=function(e){function t(){return e.call(this),this.modalAlpha=0,null!=t._instance?void console.warn("不能重复实例化本类WindowManager！"):(this.winList={},void(this._alertDataList=new Array))}__extends(t,e);var n=__define,i=t,s=i.prototype;return n(t,"instance",function(){return t._instance}),s.open=function(e,t){null!=e&&e==Alert?this._alertDataList.push(t):null!=this.currentWin&&(console.log("关闭旧窗口："+this.currentWin),this.close(this.currentWin)),e!=this.currentWin&&null!=e&&(null==this.winList[e]&&(this.winList[e]=new e),this.addPopUp(this.winList[e],!0),this.winList[e].enter(t),this.currentWin=this.winList[e])},s.close=function(e,t){if(null!=this.winList[e])this.removePopUp(this.winList[e]),this.winList[e].exit();else{var n=this.currentWin;null!=this.currentWin&&this.contains(n)&&(this.removeChild(n),n.exit())}this.currentWin=null,this.exit()},s.enter=function(e){null==this.bg&&(this.bg=new egret.Sprite,this.bg.graphics.beginFill(0,this.modalAlpha),this.bg.graphics.drawRect(0,0,this.stage.stageWidth,this.stage.stageHeight),this.bg.graphics.endFill(),this.bg.width=this.stage.stageWidth,this.bg.height=this.stage.stageHeight,this.addChildAt(this.bg,0),this.bg.touchEnabled=!0)},s.exit=function(e){null!=this.parent&&this.parent.removeChild(this)},s.destroy=function(){this.exit()},s.addPopUp=function(e,t){void 0===t&&(t=!0),e.alpha=0,this.addChild(e),TweenMax.to(e,.2,{alpha:1})},s.removePopUp=function(e){this.contains(e)&&this.removeChild(e)},n(s,"alertDataList",function(){return this._alertDataList}),t._instance=new t,t}(egret.Sprite);egret.registerClass(WindowManager,"WindowManager");var AndroidInterface=function(){function e(){}var t=(__define,e),n=t.prototype;return n.closeApp=function(e){egret.ExternalInterface.call("2N","quit"),console.log("执行了条用外部方法：退出应用")},n.recharge=function(e){},n.scan=function(e){egret.ExternalInterface.call("2N","scan"),console.warn("执行了条用外部方法:扫码")},n.onSocketClose=function(e){ClientModel.instance.openAlert(2)},n.onLoadeBegin=function(e){},n.onLoadeComplete=function(e){},n.onLoadeError=function(e){},n.callfunction=function(e){},n.onInitComplete=function(e){},e}();egret.registerClass(AndroidInterface,"AndroidInterface",["INative"]);var InterfaceManager=function(){function e(){if("web"==egret.Capabilities.runtimeType)return void(this.currentNative=new WebInterface);switch(egret.Capabilities.os){case"iOS":this.currentNative=new IosInterface,ClientModel.instance.clientType=1;break;case"Android":this.currentNative=new AndroidInterface,ClientModel.instance.clientType=2;break;case"Windows PC":case"Mac OS":this.currentNative=new WebInterface,ClientModel.instance.clientType=0;break;case"Windows Phone":this.currentNative=new WebInterface,ClientModel.instance.clientType=3;break;default:this.isWeiXin&&(this.currentNative=new WebInterface)}}var t=__define,n=e,i=n.prototype;return t(i,"isWeiXin",function(){var e=navigator.userAgent.toString(),t=e.match(/MicroMessenger/i);return"MicroMessenger"==t?!0:!1}),t(i,"isMove",function(){switch(egret.Capabilities.os){case"iOS":case"Android":return!0;default:return!1}}),t(e,"instance",function(){return null==this._instance&&(this._instance=new e),this._instance}),i["native"]=function(){return this.currentNative},i.closeApp=function(t){e.instance.currentNative.closeApp(t)},i.recharge=function(t){e.instance.currentNative.recharge(t)},i.scan=function(t){e.instance.currentNative.scan(t)},i.onSocketClose=function(t){e.instance.currentNative.onSocketClose(t)},i.onLoadeBegin=function(t){e.instance.currentNative.onLoadeBegin(t)},i.onLoadeComplete=function(t){e.instance.currentNative.onLoadeComplete(t)},i.onLoadeError=function(t){e.instance.currentNative.onLoadeError(t)},i.callfunction=function(t){e.instance.currentNative.callfunction(t)},i.onInitComplete=function(t){e.instance.currentNative.onInitComplete(t)},e}();egret.registerClass(InterfaceManager,"InterfaceManager");var IosInterface=function(){function e(){}var t=(__define,e),n=t.prototype;return n.closeApp=function(e){},n.recharge=function(e){},n.scan=function(e){},n.onSocketClose=function(e){},n.onLoadeBegin=function(e){},n.onLoadeComplete=function(e){},n.onLoadeError=function(e){},n.callfunction=function(e){},n.onInitComplete=function(e){},e}();egret.registerClass(IosInterface,"IosInterface",["INative"]);var WebInterface=function(){function e(){}var t=(__define,e),n=t.prototype;return n.closeApp=function(e){window.open("lua://CloseHelp.lobby.command"),ConnectionManager.instance.isConnected&&ConnectionManager.instance.close()},n.recharge=function(e){window.open("http://newshop.ourgame.com/class.shtml?flag=2&templateID=19&ClassID=21&ClassName=t")},n.scan=function(e){},n.onSocketClose=function(e){ClientModel.instance.openAlert(2)},n.onLoadeBegin=function(e){window.onWebViewShouldStartLoading(e)},n.onLoadeComplete=function(e){},n.onLoadeError=function(e){window.OnDidFailLoading(e)},n.callfunction=function(e){window.open("lua://webview.touch"+e),ClientModel.instance.openAlert("lua://webview.touch"+e)},n.onInitComplete=function(e){window.location.href="lua://webview.miniGameInitComplete"},e}();egret.registerClass(WebInterface,"WebInterface",["INative"]);var WxInterface=function(){function e(){}var t=(__define,e),n=t.prototype;return n.closeApp=function(e){console.log("执行了条用外部方法：退出应用")},n.recharge=function(e){},n.scan=function(e){console.log("执行了条用外部方法:扫码")},n.onSocketClose=function(e){ClientModel.instance.openAlert(2)},n.onLoadeBegin=function(e){},n.onLoadeComplete=function(e){},n.onLoadeError=function(e){},n.callfunction=function(e){},n.onInitComplete=function(e){},e}();egret.registerClass(WxInterface,"WxInterface",["INative"]);var ConnectionManager=function(){function e(){this.connCount=0,this.isActiveClose=!1,this.byteData=new egret.ByteArray;RES.getRes("PokerSlotsMessage_proto");switch(this._sendHelper=new MsgSendHelper(this.message),this._receiveHelper=new MsgReceiveHelper(this.message),e.CONN_TYPE){case 1:this.socket=new LocalHandler(this._receiveHelper.onMessage);break;case 2:this.socket=new WebSocketHandler(this._receiveHelper.onMessage,this);break;case 3:this.socket=new SocketIoHandler(this._receiveHelper.onMessage,this)}}var t=__define,n=e,i=n.prototype;return t(e,"instance",function(){return null==this._instance&&(this._instance=new e),this._instance}),i.send=function(e,t){this.socket.send(e,t)},i.initData=function(e,t){this.ip=e,this.port=t,this.conn()},i.conn=function(){e._instance.socket.conn(e._instance.ip,e._instance.port)},i.onClose=function(e){InterfaceManager.instance.onSocketClose(e)},i.close=function(e){this.socket.close()},t(i,"isConnected",function(){return this.socket.isConnected()}),t(i,"sendHelper",function(){return this._sendHelper}),t(i,"receiveHelper",function(){return this._receiveHelper}),i.onConnSuccess=function(){e.instance.sendHelper.login()},i.autoConnction=function(){TimerManager.instance.doOnce(e.CONN_INTERVAL*Math.pow(2,e.instance.connCount),e.instance.conn),e.instance.connCount++,console.log("自动重连，第"+e.instance.connCount+"次，	"+TimeUtils.formatDate(TimeUtils.timestampDate()))},e.CONN_TYPE=1,e.CONN_INTERVAL=2e3,e}();egret.registerClass(ConnectionManager,"ConnectionManager");var SocketIoHandler=function(){function e(e,t){this.callback=e,this.manager=t}var t=(__define,e),n=t.prototype;return n.conn=function(e,t){console.log("配置文件中服务器ip与端口："+e+":"+t),this.socket=io.connect("ws://172.28.26.138:7777/websocket"),this.init()},n.send=function(e,t){this.socket.emit("message",t)},n.init=function(){this.socket.on("news",this.newMessage)},n.newMessage=function(e){console.log(e)},n.isConnected=function(){return!0},n.close=function(){},e}();egret.registerClass(SocketIoHandler,"SocketIoHandler",["ISocket"]);var WebSocketHandler=function(){function e(e,t){this.callback=e,this.manager=t,this.socket=new egret.WebSocket,this.socket.type=egret.WebSocket.TYPE_BINARY,this.socket.addEventListener(egret.ProgressEvent.SOCKET_DATA,this.onReceiveMessage,this),this.socket.addEventListener(egret.Event.CONNECT,this.onSocketOpen,this),this.socket.addEventListener(egret.Event.CLOSE,this.onSocketClose,this),this.socket.addEventListener(egret.IOErrorEvent.IO_ERROR,this.onSocketError,this)}var t=(__define,e),n=t.prototype;return n.conn=function(e,t){console.log("配置文件中服务器ip与端口："+e),this.socket.connectByUrl(e)},n.send=function(e,t){var n=new egret.ByteArray;n.writeInt(e),n.writeInt(t.byteLength),n.writeInt(0),n.writeBytes(new egret.ByteArray(t)),n.position=0,this.socket.writeBytes(n,0,n.bytesAvailable),this.socket.flush()},n.onReceiveMessage=function(e){var t=new egret.ByteArray;if(this.socket.readBytes(t),t.bytesAvailable>0){if(null!=this.callback){var n=t.readInt(),i=t.readInt(),s=(t.readInt(),new egret.ByteArray);s.writeBytes(t,t.position,i),s.position=0,this.callback(n,s)}}else console.error("非法消息。可用字节："+t.bytesAvailable+"/长度："+t.length+"/指针位置："+t.position)},n.onSocketOpen=function(e){console.log("onSocketOpen"),0==ConfigModel.instance.isShowLogin&&(ClientModel.instance.onConn(),ConnectionManager.instance.onConnSuccess());var t=new egret.ByteArray;ConfigModel.instance.debug&&(t.writeUTF("172.28.14.209"),t.writeInt(7777),t.writeBoolean(!0),this.socket.writeBytes(t,0,t.bytesAvailable),this.socket.flush())},n.onSocketClose=function(e){console.warn("onSocketClose"),this.manager.onClose("onSocketClose"),0==ConnectionManager.instance.isActiveClose&&ConnectionManager.instance.autoConnction()},n.onSocketError=function(e){console.error("onSocketError"),this.manager.onClose("onSocketError")},n.isConnected=function(){return this.socket.connected},n.close=function(){this.socket.close()},e}();egret.registerClass(WebSocketHandler,"WebSocketHandler",["ISocket"]);var BaseMessage=function(){function e(){}var t=(__define,e),n=t.prototype;return n.read=function(e){},e}();egret.registerClass(BaseMessage,"BaseMessage");var MsgLoginReq=function(e){function t(){e.call(this)}__extends(t,e);var n=(__define,t);n.prototype;return t}(BaseMessage);egret.registerClass(MsgLoginReq,"MsgLoginReq");var MsgReceiveHelper=function(){function e(t){e.instance=this,this._message=t,this.userModel=UserModel.instance,this.clientModel=ClientModel.instance}var t=__define,n=e,i=n.prototype;return t(i,"msg",function(){return this._message}),i.sender=function(e){this._sender=e},i.onMessage=function(t,n){var i,s=e.instance.msg;switch(t){case 1:i=s.build("DuxLiveTick");var a=i.decode(n.buffer);parseInt(a.time);break;case MsgType.GLFS_PeriodChangeACK:HallClientModel.instance.onGoResult(n);break;case MsgType.A_DICE_INFO:HallClientModel.instance.onDiceInfo(n);break;case MsgType.A_LOGIN:GameDispatcher.send(BaseEvent.LOGIN_RESULT_EVENT);break;case MsgType.A_GAME_POOL:HallClientModel.instance.onPool(n.value)}},e}();egret.registerClass(MsgReceiveHelper,"MsgReceiveHelper");var MsgSendHelper=function(){function e(t){this.clientModel=ClientModel.instance,this.userModel=UserModel.instance,e.instance=this,this._message=t}var t=__define,n=e,i=n.prototype;return i.sender=function(e){this._sender=e},t(i,"msg",function(){return this._message}),i.login=function(){return ConnectionManager.instance.send(MsgType.R_LOGIN,{name:UserModel.instance.userName}),2},i.diceInfo=function(){ConnectionManager.instance.send(MsgType.R_DICE_INFO,{})},i.diceGo=function(){ConnectionManager.instance.send(MsgType.GLFS_Ping,{})},e}();egret.registerClass(MsgSendHelper,"MsgSendHelper");var MsgType=function(){function e(){}var t=(__define,e);t.prototype;return e.GLID_BASE_FISH=1044480,e.REQ_BASE=0,e.ACK_BASE=10,e.GLFS_NetworkEvent=e.GLID_BASE_FISH+1,e.GLFS_Ping=e.GLID_BASE_FISH+513,e.GLFS_PeriodChangeACK=e.GLID_BASE_FISH+514,e.GLFS_PeriodSync=e.GLID_BASE_FISH+515,e.GLFS_PlayerJoinACK=e.GLID_BASE_FISH+516,e.GLFS_PlayerLeaveACK=e.GLID_BASE_FISH+517,e.GLFS_PurchaseBulletTipACK=e.GLID_BASE_FISH+518,e.GLFS_PurchaseBulletREQ=e.GLID_BASE_FISH+519,e.GLFS_PurchaseBulletACK=e.GLID_BASE_FISH+520,e.GLFS_StandardModeSelectREQ=e.GLID_BASE_FISH+521,e.GLFS_PeriodLeaveTimeACK=e.GLID_BASE_FISH+521,e.GLFS_StandardModeSelectACK=e.GLID_BASE_FISH+528,e.GLFS_ShowStageAwards=e.GLID_BASE_FISH+529,e.GLFS_GameResult=e.GLID_BASE_FISH+530,e.GLFS_Checkout=e.GLID_BASE_FISH+531,e.GLFS_RestartACK=e.GLID_BASE_FISH+532,e.GLFS_RestartGameREQ=e.GLID_BASE_FISH+533,e.GLFS_ModeSelectACK=e.GLID_BASE_FISH+534,e.GLFS_TimeReport=e.GLID_BASE_FISH+535,e.GLFS_GameInit=e.GLID_BASE_FISH+536,e.GLFS_NoMoneyACK=e.GLID_BASE_FISH+537,e.GLFS_MGPlayerStateACK=e.GLID_BASE_FISH+544,e.GLFS_MGChangeHostACK=e.GLID_BASE_FISH+545,e.GLFS_MGKickACK=e.GLID_BASE_FISH+546,e.GLFS_MGStartGameREQ=e.GLID_BASE_FISH+547,e.GLFS_MGStateChanged=e.GLID_BASE_FISH+548,e.GLFS_MGGameResult=e.GLID_BASE_FISH+560,e.GLFS_BombAttributeACK=e.GLID_BASE_FISH+576,e.GLFS_BeanLimitACK=e.GLID_BASE_FISH+577,e.GLFS_UpdateBeanACK=e.GLID_BASE_FISH+578,e.GLFS_MaxLossACK=e.GLID_BASE_FISH+582,e.GLFS_NotPurchaseBulletREQ=e.GLID_BASE_FISH+613,e.GLFS_UpdateBeanREQ=e.GLID_BASE_FISH+581,e.GLFS_FreeRechargeTipACK=e.GLID_BASE_FISH+584,e.GLFS_FreeRechargeCommitACK=e.GLID_BASE_FISH+585,e.GLFS_QueryBeanREQ=e.GLID_BASE_FISH+592,e.GLFS_QueryBeanACK=e.GLID_BASE_FISH+593,e.FreeRechargeREQ=e.GLID_BASE_FISH+594,e.GLFS_WallowTimeBoxACK=e.GLID_BASE_FISH+595,e.GLFS_CoinFromRecoverBulletACK=e.GLID_BASE_FISH+614,e.GLFS_FisherUpLevelACK=e.GLID_BASE_FISH+612,e.GLFS_AllServiceBroadcast=e.GLID_BASE_FISH+608,e.GLFS_FisherUpLevelREQ=e.GLID_BASE_FISH+611,e.GLFS_ChangeLevelACK=e.GLID_BASE_FISH+769,e.GLFS_ShootREQ=e.GLID_BASE_FISH+772,e.GLFS_ShootACK=e.GLID_BASE_FISH+773,e.GLFS_ExplodeREQ=e.GLID_BASE_FISH+770,e.GLFS_ExplodeACK=e.GLID_BASE_FISH+771,e.GLFS_CanonRotationACK=e.GLID_BASE_FISH+774,e.GLFS_AutoShootACK=e.GLID_BASE_FISH+775,e.GLFS_ShellGameStartACK=e.GLID_BASE_FISH+1025,e.GLFS_ShellGameSelectACK=e.GLID_BASE_FISH+1026,e.GLFS_DiamondGameStartACK=e.GLID_BASE_FISH+1027,e.GLFS_DiamondGameResultACK=e.GLID_BASE_FISH+1028,e.GLFS_AddDiamondACK=e.GLID_BASE_FISH+1029,e.GLFS_DiamondGameProgressACK=e.GLID_BASE_FISH+1030,e.GLFS_SuperCannonReadyACK=e.GLID_BASE_FISH+1031,e.GLFS_ShellRefreshCoinACK=e.GLID_BASE_FISH+1032,e.GLFS_FishLotteryACK=e.GLID_BASE_FISH+1033,e.GLFS_FullScreenCannonReadyACK=e.GLID_BASE_FISH+1040,e.GLFS_RefreshDiamondTriggerNum=e.GLID_BASE_FISH+1042,e.GLFS_AngryOfGodReadyACK=e.GLID_BASE_FISH+1043,e.GLFS_StartBingoAck=e.GLID_BASE_FISH+1044,e.GLFS_BingoDataReq=e.GLID_BASE_FISH+1045,e.GLFS_BingoDataAck=e.GLID_BASE_FISH+1046,e.GLFS_BingoEndReq=e.GLID_BASE_FISH+1047,e.GLFS_BingoEndAck=e.GLID_BASE_FISH+1048,e.GLFS_DiamondRefreshCoinACK=e.GLID_BASE_FISH+1049,e.GLFS_UseSuperWeaponsReq=e.GLID_BASE_FISH+1056,e.GLFS_RewardTaskStartAck=e.GLID_BASE_FISH+1057,e.GLFS_RewardTaskEndAck=e.GLID_BASE_FISH+1058,e.GLFS_ShellGameOverTimeResultACK=e.GLID_BASE_FISH+1059,e.GLFS_UserBackpackReq=e.GLID_BASE_FISH+1072,e.GLFS_UserBackpackAck=e.GLID_BASE_FISH+1073,e.GLFS_UsePropReq=e.GLID_BASE_FISH+1075,e.GLFS_UsePropAck=e.GLID_BASE_FISH+1076,e.GLFS_TidyBackpackReq=e.GLID_BASE_FISH+1077,e.GLFS_TidyBackpackAck=e.GLID_BASE_FISH+1078,e.GLFS_UnLoadPropReq=e.GLID_BASE_FISH+1079,e.GLFS_UnLoadPropAck=e.GLID_BASE_FISH+1080,e.GLFS_UpdateUserBackpack=e.GLID_BASE_FISH+1081,e.GLFS_RouletteBegin=e.GLID_BASE_FISH+595,e.GLFS_RouletteEnd=e.GLID_BASE_FISH+596,e.GLFS_RouletteAward=e.GLID_BASE_FISH+598,e.GLFS_DebugServerPos=e.GLID_BASE_FISH+2049,e.GLFS_DebugCommandREQ=e.GLID_BASE_FISH+2050,e.GLFS_BombPowerTest=e.GLID_BASE_FISH+2051,e.GLFS_DebugConfigACK=e.GLID_BASE_FISH+2052,e.GLFS_UpdateDebugPanelREQ=e.GLID_BASE_FISH+2053,e.GLFS_UpdateDebugPanelACK=e.GLID_BASE_FISH+2054,e.GLFS_CommitDebugPanelACK=e.GLID_BASE_FISH+2055,e.GLFS_GameBalanceSearchReq=e.GLID_BASE_FISH+2308,e.GLFS_GameBalanceREQ=e.GLID_BASE_FISH+2309,e.GLFS_GameBalanceACK=e.GLID_BASE_FISH+2310,e.GLFS_DailyCheckoutREQ=e.GLID_BASE_FISH+2311,e.GLFS_DailyCheckoutACK=e.GLID_BASE_FISH+2312,e.GLFS_HonorRankREQ=e.GLID_BASE_FISH+2324,e.GLFS_HonorRankACK=e.GLID_BASE_FISH+2325,e.GLFS_MailHeaderREQ=e.GLID_BASE_FISH+2328,e.GLFS_MailHeaderACK=e.GLID_BASE_FISH+2329,e.GLFS_MailContentREQ=e.GLID_BASE_FISH+2330,e.GLFS_MailContentACK=e.GLID_BASE_FISH+2331,e.GLFS_MailDeleteREQ=e.GLID_BASE_FISH+2332,e.GLFS_MailDeleteACK=e.GLID_BASE_FISH+2333,e.GLFS_MailAddReq=e.GLID_BASE_FISH+2334,e.GLFS_MailAddAck=e.GLID_BASE_FISH+2335,e.GLFS_ClearCustomData=e.GLID_BASE_FISH+2336,e.GLFS_UnreadMailACK=e.GLID_BASE_FISH+2337,e.GLFS_RaceGameStartACK=e.GLID_BASE_FISH+1032,e.GLFS_RaceGameBetREQ=e.GLID_BASE_FISH+1033,e.GLFS_RaceGameBetACK=e.GLID_BASE_FISH+1040,e.GLFS_RaceGameBetOver=e.GLID_BASE_FISH+1041,e.GLFS_RaceGameBetResult=e.GLID_BASE_FISH+1042,e.GLFS_RaceGameSeedACK=e.GLID_BASE_FISH+1048,e.GLFS_SharkGameStartACK=e.GLID_BASE_FISH+1043,e.GLFS_SharkGameResultACK=e.GLID_BASE_FISH+1044,e.GLFS_SharkGameProgressACK=e.GLID_BASE_FISH+1045,e.GLFS_ShoalFishStartACK=e.GLID_BASE_FISH+1046,e.GLFS_SharkGamePhaseTimeACK=e.GLID_BASE_FISH+1047,e.GLFS_SharkGameSendBadgeACK=e.GLID_BASE_FISH+1056,e.GLFS_SharkGameCostChampionACK=e.GLID_BASE_FISH+1057,e.GLFS_ChatNotifyMessage=e.GLID_BASE_FISH+625,e.GLFS_UserCheckOutACK=e.GLID_BASE_FISH+642,e.GLFS_UserCheckOutREQ=e.GLID_BASE_FISH+641,e.GLFS_KeepOnGameREQ=e.GLID_BASE_FISH+643,e.GLFS_KeepOnGameACK=e.GLID_BASE_FISH+644,e.GLFS_NotifyMessage=e.GLID_BASE_FISH+599,e.GLFS_RequestCheckAchievement=e.GLID_BASE_FISH+1281,e.GLFS_CommonLockFishReq=e.GLID_BASE_FISH+2405,e.GLFS_CommonLockFishAck=e.GLID_BASE_FISH+2406,e.GLFS_CommonLockInstanceReq=e.GLID_BASE_FISH+2407,e.GLFS_CommonLockInstanceAck=e.GLID_BASE_FISH+2408,e.GLFS_CheckBuyBulletREQ=e.GLID_BASE_FISH+599,e.GLFS_BettingValueForBombACK=e.GLID_BASE_FISH+2402,e.GLFS_DoubleTimesForFishACK=e.GLID_BASE_FISH+2403,e.GLFS_ScorePromptACK=e.GLID_BASE_FISH+2404,e.GLFS_SpecialTimesFishConfigAck=e.GLID_BASE_FISH+1063,e.GLFS_NoviceGuideTaskProcessAck=e.GLID_BASE_FISH+1060,e.GLFS_UpdateUserAchievementArrayReq=e.GLID_BASE_FISH+1061,e.GLFS_QuoridorMailNoticeReq=e.GLID_BASE_FISH+1062,e.GLFS_RefreshHandselPrizePoolAck=e.GLID_BASE_FISH+2437,e.GLFS_HandselGameResultAck=e.GLID_BASE_FISH+2438,e.GLFS_UserHandselInfosRankReq=e.GLID_BASE_FISH+2439,e.GLFS_UserHandselInfosRankAck=e.GLID_BASE_FISH+2440,e.GLFS_OurGameInnerGameMarkReq=e.GLID_BASE_FISH+2579,e.GLFS_NoTrialBulletACK=e.GLID_BASE_FISH+1064,e.GLFS_AddSbsStarACK=e.GLID_BASE_FISH+1065,e.GLFS_AddSbsLeftTimesACK=e.GLID_BASE_FISH+1066,e.GLFS_QueryAllSbsGameConfAck=e.GLID_BASE_FISH+2453,e.GLFS_QueryCurNOPACK=e.GLID_BASE_FISH+2456,e.GLFS_SGBroadCastACK=e.GLID_BASE_FISH+2459,e.GLFS_FishIslandRegistMailOBReq=e.GLID_BASE_FISH+2466,e.GLFS_FishIslandRegistMailOBAck=e.GLID_BASE_FISH+2467,e.R_LOGIN=e.REQ_BASE+1,e.A_LOGIN=e.ACK_BASE+1,e.R_DICE_INFO=e.REQ_BASE+10,e.A_DICE_INFO=e.ACK_BASE+10,e.A_GAME_POOL=e.REQ_BASE+100,e}();egret.registerClass(MsgType,"MsgType");var LocalHandler=function(){function e(t){this.userMoney=888999777,this.baseAnte=0,this.batTimes=0,this.pool=9589000001,this.awardMoney=0,this.name="",e.that=this,this.callback=t,this.diceInfo=new DiceInfo,this.initInfo()}var t=(__define,e),n=t.prototype;return n.initInfo=function(){this.diceInfo.availableTimes=10,this.diceInfo.fishIndex=0},n.isConnected=function(){return!0},n.close=function(){},n.send=function(e,t){var n;switch(e){case MsgType.GLFS_AddSbsLeftTimesACK:n=this.login;break;case MsgType.GLFS_Ping:n=this.onDiceGo;break;case MsgType.R_DICE_INFO:n=this.onDiceInfo;break;case MsgType.R_LOGIN:n=this.login}n.apply(this,[e,t])},n.conn=function(e,t){},n.returnMsg=function(t,n){if(null!=e.that.callback){var i=new egret.ByteArray;i.buffer=n.toArrayBuffer(),e.that.callback(t,i)}},n.returnMsg2=function(t,n){null!=e.that.callback&&e.that.callback(t,n)},n.login=function(e,t){this.name=t.name,this.returnMsg2(MsgType.A_LOGIN,{success:0}),this.jpPool(),TimerManager.instance.doLoop(1500,this.jpPool,this)},n.jpPool=function(){this.pool+=RandomUtil.randInt(5,99),this.returnMsg2(MsgType.A_GAME_POOL,{value:this.pool})},n.onDiceGo=function(t,n){this.diceInfo.availableTimes--;var i=RandomUtil.randInt(1,6);this.diceInfo.fishIndex+=i,e.that.returnMsg2(MsgType.GLFS_PeriodChangeACK,{num:this.diceInfo.fishIndex,dice:i}),e.that.returnMsg2(MsgType.A_DICE_INFO,this.diceInfo)},n.onDiceInfo=function(t,n){e.that.returnMsg2(MsgType.A_DICE_INFO,this.diceInfo)},e.MAX_CARDS=5,e}();egret.registerClass(LocalHandler,"LocalHandler",["ISocket"]);var BitMapUtil=function(){function e(){}var t=(__define,e);t.prototype;return e.createBitmapByName=function(e){var t=new egret.Bitmap,n=RES.getRes(e);return t.texture=n,t},e}();egret.registerClass(BitMapUtil,"BitMapUtil");var MovieclipUtils=function(){function e(){}var t=(__define,e);t.prototype;return e.createMc=function(e,t,n){var i,s=RES.getRes(t),a=RES.getRes(e),o=new egret.MovieClipDataFactory(s,a);return i=new egret.MovieClip(o.generateMovieClipData(n)),i.stop(),i.play(-1),i.touchEnabled=!1,i},e.getFactory=function(e,t){var n=RES.getRes(t),i=RES.getRes(e),s=new egret.MovieClipDataFactory(n,i);return s},e}();egret.registerClass(MovieclipUtils,"MovieclipUtils");var ButtonUtils=function(){function e(){}var t=(__define,e);t.prototype;return e.simulateClick=function(e){null!=e&&(e.currentState="down")},e}();egret.registerClass(ButtonUtils,"ButtonUtils");var HitTestUtils=function(){function e(){}var t=(__define,e);t.prototype;return e.hitTest=function(e,t,n){void 0===n&&(n=!1);var i=e.getBounds(),s=t.getBounds(),a=!1;return i.x=e.x-e.anchorOffsetX,i.y=e.y-e.anchorOffsetY,s.x=t.x,s.y=t.y,egret.Rectangle.release(i),egret.Rectangle.release(s),t.parent&&(t.parent.graphics.clear(),t.parent.graphics.beginFill(0,.5),t.parent.graphics.drawRect(s.x,s.y,s.width,s.height),t.parent.graphics.endFill()),e.parent&&(t.parent.graphics.clear(),t.parent.graphics.beginFill(0,.5),t.parent.graphics.drawRect(i.x,i.y,i.width,i.height),t.parent.graphics.endFill()),a=i.intersects(s),n?void 0:a},e.hitTestByRec=function(e,t){return e.intersects(t)},e}();egret.registerClass(HitTestUtils,"HitTestUtils");var MatrixUtils=function(){function e(){}var t=__define,n=e;n.prototype;return t(e,"blurFliter",function(){return new egret.BlurFilter(1,1)}),e.colorMatrix=[1,0,0,0,100,0,1,0,0,100,0,0,1,0,100,0,0,0,1,0],e.greenx2=[1,0,0,0,0,0,2,0,0,0,0,0,1,0,0,0,0,0,1,0],e.red=[1,0,0,0,100,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],e.change=[1,0,0,0,0,0,1,0,0,0,0,0,2,0,0,0,0,0,1,0],e}();egret.registerClass(MatrixUtils,"MatrixUtils");var PcKeyBoardHelper=function(){function e(){this.isListening=!1,this.list={}}var t=__define,n=e,i=n.prototype;return t(e,"instance",function(){return null==e._instance&&(e._instance=new e),e._instance}),i.add=function(){0==this.isListening&&(this.isListening=!0,document.addEventListener("keydown",e.instance.onKeyDown))},i.onKeyDown=function(t){var n;for(n in e.instance.list){var i=e.instance.list[n];i.callback.call(i.target,t)}},i.addListener=function(t,n){var i=egret.getQualifiedClassName(n);if(null==e._instance.list[i]){var s=new KeyVo(i,n,t);e._instance.list[s.name]=s}e._instance.add()},i.removeListener=function(t){var n=egret.getQualifiedClassName(t);null!=e._instance.list[n]&&delete e._instance.list[n],this.checkCount()},i.checkCount=function(){for(var t in e._instance.list)return;document.removeEventListener("keydown",e.instance.onKeyDown),this.isListening=!1
},e}();egret.registerClass(PcKeyBoardHelper,"PcKeyBoardHelper");var KeyVo=function(){function e(e,t,n){this.name="",this.name=e,this.target=t,this.callback=n}var t=(__define,e);t.prototype;return e}();egret.registerClass(KeyVo,"KeyVo");var PcMouseHelper=function(){function e(){this.isListening=!1,this.list=new Array}var t=__define,n=e,i=n.prototype;return i.add=function(){0==this.isListening&&(this.isListening=!0,this.canvas=document.getElementsByTagName("CANVAS")[0],this.canvas.addEventListener("mousemove",this.onMove))},i.addListener=function(e){this.add(),this.list.push(e)},i.removeListener=function(t){e._instance.list.indexOf(t)>-1&&(e._instance.list.splice(e._instance.list.indexOf(t),1),this.checkCount())},i.checkCount=function(){for(var t in e._instance.list)return;e._instance.canvas.style.cursor="auto",this.canvas.removeEventListener("mousemove",this.onMove),this.isListening=!1},i.onMove=function(t){for(var n=e._instance.list.length,i=e._instance.getPoint(t.currentTarget,t.x,t.y),s=0;n>s;s++){if(e._instance.list[s].hitTestPoint(i.x,i.y))return void(e._instance.canvas.style.cursor="pointer")}e._instance.canvas.style.cursor="auto"},i.getPoint=function(e,t,n){var i=window.getComputedStyle(e,null),s=e.getBoundingClientRect();return{x:(t-s.left)*(e.width/parseFloat(i.width)),y:(n-s.top)*(e.height/parseFloat(i.height))}},t(e,"instance",function(){return null==e._instance&&(e._instance=new e),e._instance}),e}();egret.registerClass(PcMouseHelper,"PcMouseHelper");var RandomUtil=function(e){function t(){e.call(this)}__extends(t,e);var n=(__define,t);n.prototype;return t.randNumber=function(e,t){return e+Math.random()*(t-e)},t.randInt=function(e,t){return e+Math.round(Math.random()*(t-e))},t.randColor=function(){return 6710886*Math.random()},t.randPt=function(e,t,n,i){return new egret.Point(e+Math.random()*(n-e),t+Math.random()*(i-t))},t}(egret.HashObject);egret.registerClass(RandomUtil,"RandomUtil");var RollNumber=function(){function e(e,t,n,i){this.speed=2,this.myArray=0,this.isDecimal=i,this.callBackFun=e,this.myArray=0,this.speed=n?n:2,this.target=t}var t=(__define,e),n=t.prototype;return n.setSpeed=function(e){this.speed=e},n.setNumber=function(e){TweenLite.to(this,this.speed,{myArray:e,onUpdate:this.updateHandler,onUpdateParams:[this]})},n.getNumber=function(){return this.myArray},n.updateHandler=function(e){e.isDecimal?e.callBackFun(e.myArray):e.callBackFun(Math.round(e.myArray))},e}();egret.registerClass(RollNumber,"RollNumber");var StringUtils=function(){function e(){}var t=(__define,e);t.prototype;return e.cutStr=function(e,t){void 0===e&&(e=""),void 0===t&&(t=6);for(var n="",i=0,s=0;i<e.length&&2*t>s;)e.charCodeAt(i)>192?s+=2:s++,n+=e.charAt(i),i++;return n.length<e.length&&(n+="..."),n},e.numSection=function(e){void 0===e&&(e=0);for(var t=e.toString(),n="",i=0;i<t.length;i++)(t.length-i)%3==0&&0!=i&&(n+=","),n+=t.charAt(i);return n},e.getStrByUnits=function(e){if(0>=e)return"0";var t=e/1e8,n=e%1e8/1e4,i=e%1e4,s="";return 0!=t&&(s=s+t+"亿"),0!=n&&(s=s+n+"万"),0==t&&0!=i&&(s+=i),s},e.randomChinese=function(){return String.fromCharCode(Math.floor(16384*Math.random())+20480)},e}();egret.registerClass(StringUtils,"StringUtils");var TimerManager=function(){function e(){this._shape=new egret.Shape,this._pool=new Array,this._handlers=new Object,this._currTimer=egret.getTimer(),this._currFrame=0,this._count=0,this._index=0,this._shape.addEventListener(egret.Event.ENTER_FRAME,this.onEnterFrame,this)}var t=__define,n=e,i=n.prototype;return i.onEnterFrame=function(e){this._currFrame++,this._currTimer=egret.getTimer();var t;for(t in this._handlers)if("undefined"!=t){var n=this._handlers[t],i=n.userFrame?this._currFrame:this._currTimer;if(i>=n.exeTime){var s=n.method,a=n.args;if(n.repeat)for(;i>=n.exeTime&&t in this._handlers;)n.exeTime+=n.delay,s.apply(n.thisObj,a);else s.apply(n.thisObj,a),this.clearTimer(t)}}else console.log(t)},i.create=function(e,t,n,i,s,a,o){void 0===s&&(s=null),void 0===a&&(a=null),void 0===o&&(o=!0);var r;if(o?(this.clearTimer(i),r=i):r=this._index++,1>n)return i.apply(null,a),-1;var c=this._pool.length>0?this._pool.pop():new TimerHandler;return c.userFrame=e,c.repeat=t,c.delay=n,c.method=i,c.thisObj=s,c.args=a,c.exeTime=n+(e?this._currFrame:this._currTimer),this._handlers[r]=c,this._count++,r},i.doOnce=function(e,t,n,i,s){return void 0===n&&(n=null),void 0===i&&(i=null),void 0===s&&(s=!0),this.create(!1,!1,e,t,n,i,s)},i.doLoop=function(e,t,n,i,s){return void 0===n&&(n=null),void 0===i&&(i=null),void 0===s&&(s=!0),this.create(!1,!0,e,t,n,i,s)},i.doFrameOnce=function(e,t,n,i,s){return void 0===n&&(n=null),void 0===i&&(i=null),void 0===s&&(s=!0),this.create(!0,!1,e,t,n,i,s)},i.doFrameLoop=function(e,t,n,i,s){return void 0===n&&(n=null),void 0===i&&(i=null),void 0===s&&(s=!0),this.create(!0,!0,e,t,n,i,s)},t(i,"count",function(){return this._count}),i.clearTimer=function(e){var t=this._handlers[e];null!=t&&(delete this._handlers[e],t.clear(),this._pool.push(t),this._count--)},i.destroy=function(){this._shape.removeEventListener(egret.Event.ENTER_FRAME,this.onEnterFrame,this)},i.running=function(e){return null!=this._handlers[e]?!0:!1},i.clearTimerByFun=function(e){this.clearTimer(e)},t(e,"instance",function(){return null==e._instance&&(e._instance=new e),e._instance}),e}();egret.registerClass(TimerManager,"TimerManager");var TimerHandler=function(){function e(){this.delay=0,this.exeTime=0}var t=(__define,e),n=t.prototype;return n.clear=function(){this.method=null,this.args=null,this.thisObj=null},e}();egret.registerClass(TimerHandler,"TimerHandler");var TimeUtils=function(){function e(){}var t=(__define,e);t.prototype;return e.timestampDate=function(){return Math.round((new Date).getTime()/1e3)},e.formatDate=function(e){var t,n,i,s=new Date(1e3*parseInt(e)).toLocaleTimeString().replace("上午","").replace("下午","").replace(":","").replace(":",""),a=new Date(1e3*parseInt(e)).toLocaleTimeString().replace("上午","").replace("下午",""),o=new Date(1e3*parseInt(e)).toLocaleTimeString(),r=o.substr(0,1),c=s,h=s,l=s,u=new Date(1e3*parseInt(e)).toLocaleDateString().replace(/\//gi,"-");if("下"==r){for(var d=0;4>d;d++)c=c.substring(0,c.length-1);if(Number(c)>=1&&Number(c)<=9){h=h.substring(1);for(var p=0;3>p;p++)l=l.substring(1)}else{for(var g=0;2>g;g++)h=h.substring(1);for(var _=0;4>_;_++)l=l.substring(1)}for(var f=0;2>f;f++)h=h.substring(0,h.length-1);t=12==Number(c)?"12":12+Number(c)}else{for(var d=0;4>d;d++)c=c.substring(0,c.length-1);if(Number(c)>=0&&Number(c)<=9){h=h.substring(1);for(var p=0;3>p;p++)l=l.substring(1)}else{for(var g=0;2>g;g++)h=h.substring(1);for(var _=0;4>_;_++)l=l.substring(1)}for(var f=0;2>f;f++)h=h.substring(0,h.length-1);t=12==Number(c)?"00":Number(c)>=10&&Number(c)<=11?"0"+Number(c):Number(c)}return n=h,i=l,a=u+" "+t+":"+n+":"+i},e}();egret.registerClass(TimeUtils,"TimeUtils");var TestEvent=function(){function e(){}var t=(__define,e);t.prototype;return e.ADD_FISH_EVENT="addFishEvent",e.CHANGE_PATH="changePath",e.CHANGE_MAP="changeMap",e.CLOSE_EVENT="closeEvent",e}();egret.registerClass(TestEvent,"TestEvent");var TestWindow=function(e){function t(){e.call(this,!1),this.skinName="resource/game_skins/TestSkin.exml",this.alpha=.6}__extends(t,e);var n=(__define,t),i=n.prototype;return i.onSkinComplete=function(t){e.prototype.onSkinComplete.call(this,t),this.x=745,this.y=120},i.enter=function(e){this.main=e,this.skinLoaded&&(this.curBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onCutBtn,this),this.changeMapBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onChangeMap,this),this.closeBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClose,this),TimerManager.instance.doLoop(1e3,this.execute,this),this.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.onTouchMove,this),this.stage.addEventListener(egret.TouchEvent.TOUCH_END,this.onTouchEnd,this))},i.exit=function(){this.onTouchEnd()},i.execute=function(e){this.skinLoaded&&(this.numText.text="生成数:"+EntityManager.instance.length,this.showNumText.text="显示数:"+this.main.game.getChildAt(1).getChildAt(1).numChildren)},i.onTouchEnd=function(e){TimerManager.instance.clearTimer(this.onMove)},i.onTouchMove=function(e){TimerManager.instance.doFrameLoop(1,this.onMove,this,[e])},i.onMove=function(e){this.x=e.stageX-(this.width>>1),this.y=e.stageY-(this.height>>1)},i.onAddBtn=function(){GameDispatcher.send(TestEvent.ADD_FISH_EVENT)},i.onCutBtn=function(){GameDispatcher.send(TestEvent.CHANGE_PATH)},i.onSBtn=function(){TimerManager.instance.clearTimer(this.onAddBtn)},i.on8Btn=function(){TimerManager.instance.doLoop(150,this.onAddBtn,this)},i.onChangeMap=function(){GameDispatcher.send(TestEvent.CHANGE_MAP)},i.onClose=function(){this.parent&&this.parent.removeChild(this)},t}(BaseComponent);egret.registerClass(TestWindow,"TestWindow",["IBase"]);var Main=function(e){function t(){e.apply(this,arguments),this.isThemeLoadEnd=!1,this.isResourceLoadEnd=!1}__extends(t,e);var n=(__define,t),i=n.prototype;return i.createChildren=function(){e.prototype.createChildren.call(this);var t=new AssetAdapter;this.stage.registerImplementation("eui.IAssetAdapter",t),this.stage.registerImplementation("eui.IThemeAdapter",new ThemeAdapter),RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.loadConfig("resource/default.res.json","resource/"),this.stage.dirtyRegionPolicy=egret.DirtyRegionPolicy.ON,this.game=new GameMain},i.onConfigComplete=function(e){RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this);var t=new eui.Theme("resource/default.thm.json",this.stage);t.addEventListener(eui.UIEvent.COMPLETE,this.onThemeLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),RES.loadGroup("preload")},i.onThemeLoadComplete=function(){this.isThemeLoadEnd=!0,this.createScene()},i.onResourceLoadComplete=function(e){"preload"==e.groupName&&(RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.removeEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.removeEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),this.isResourceLoadEnd=!0,this.createScene())},i.createScene=function(){this.isThemeLoadEnd&&this.isResourceLoadEnd&&this.addChild(this.game)},i.onAssetsComplete=function(){if(ConfigModel.instance.showTest){var e=new TestWindow;this.addChild(e),e.enter(this)}},i.onItemLoadError=function(e){console.warn("Url:"+e.resItem.url+" has failed to load")},i.onResourceLoadError=function(e){console.warn("Group:"+e.groupName+" has failed to load"),this.onResourceLoadComplete(e)},i.onResourceProgress=function(e){"preload"==e.groupName&&LoadingUI.instance.setProgress(e.itemsLoaded,e.itemsTotal)},t.STAGE_WIDTH=960,t.STAGE_HEIGHT=570,t.VERSION="α1.0.0：160815-1514",t}(eui.UILayer);egret.registerClass(Main,"Main");var ThemeAdapter=function(){function e(){}var t=(__define,e),n=t.prototype;return n.getTheme=function(e,t,n,i){function s(e){t.call(i,e)}function a(t){t.resItem.url==e&&(RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,a,null),n.call(i))}RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,a,null),RES.getResByUrl(e,s,this,RES.ResourceItem.TYPE_TEXT)},e}();egret.registerClass(ThemeAdapter,"ThemeAdapter",["eui.IThemeAdapter"]);